function MOD = MVS_1_0_1_ModSpec_vv4(uniqID)

    if nargin < 1
        MOD.uniqID = '';
    else
        MOD.uniqID = uniqID;
    end

    MOD.model_name = 'mvs_si_1_0_1';
    MOD.model_description = '';

    MOD.NIL.node_names = {'d', 'g', 's', 'b'};
    MOD.NIL.refnode_name = 'b';
    MOD.internal_unk_names = {'vdib', 'vsib'};
    MOD.explicit_output_names = {'idb', 'igb', 'isb'};
    MOD.implicit_equation_names = {'KCL-di', 'KCL-si'};
    MOD.u_names = {};

    MOD.output_names = {};
    MOD.output_matrix = [];
    
    MOD.parm_names = { ...
            'version', ...
            'Type', ...
            'W', ...
            'Lgdr', ...
            'dLg', ...
            'Cg', ...
            'etov', ...
            'delta', ...
            'n0', ...
            'Rs0', ...
            'Rd0', ...
            'Cif', ...
            'Cof', ...
            'vxo', ...
            'Mu', ...
            'Beta', ...
            'Tjun', ...
            'phib', ...
            'Gamma', ...
            'Vt0', ...
            'Alpha', ...
            'mc', ...
            'CTM_select', ...
            'CC', ...
            'nd', ...
            'gmin', ...
        };
    MOD.parm_defaultvals = { ...
            1.010000000000e+00, ...
            1.000000000000e+00, ...
            1.000000000000e-04, ...
            8.000000000000e-06, ...
            1.050000000000e-06, ...
            2.200000000000e-06, ...
            1.300000000000e-03, ...
            1.000000000000e-01, ...
            1.500000000000e+00, ...
            1.000000000000e+02, ...
            1.000000000000e+02, ...
            1.000000000000e-12, ...
            2.000000000000e-13, ...
            7.650000000000e+06, ...
            2.000000000000e+02, ...
            1.700000000000e+00, ...
            2.980000000000e+02, ...
            1.200000000000e+00, ...
            0.000000000000e+00, ...
            4.860000000000e-01, ...
            3.500000000000e+00, ...
            2.000000000000e-01, ...
            1.000000000000e+00, ...
            0.000000000000e+00, ...
            0.000000000000e+00, ...
            1.000000000000e-12, ...
        };
    MOD.parm_vals = MOD.parm_defaultvals;

    MOD.support_initlimiting = 1;
    MOD.limited_var_names = {'vdiblim', 'vgblim', 'vsiblim'};
    MOD.vecXY_to_limitedvars_matrix = [ ...
            0.000000000000e+00, 0.000000000000e+00, 0.000000000000e+00, 1.000000000000e+00, 0.000000000000e+00; ...
            0.000000000000e+00, 1.000000000000e+00, 0.000000000000e+00, 0.000000000000e+00, 0.000000000000e+00; ...
            0.000000000000e+00, 0.000000000000e+00, 0.000000000000e+00, 0.000000000000e+00, 1.000000000000e+00; ...
        ];

    MOD.name = @(inMOD)(inMOD.uniqID);
    MOD.ModelName = @(inMOD)(inMOD.model_name);
    MOD.description = @(inMOD)(inMOD.model_description);
    MOD.InternalUnkNames = @(inMOD)(inMOD.internal_unk_names);
    MOD.ExplicitOutputNames = @(inMOD)(inMOD.explicit_output_names);
    MOD.ImplicitEquationNames = @(inMOD)(inMOD.implicit_equation_names);
    MOD.uNames = @(inMOD)(inMOD.u_names);
    MOD.IOnames = @(inMOD)(inMOD.IO_names);
    MOD.OtherIONames = @(inMOD)(inMOD.OtherIO_names);
    MOD.NIL.NodeNames = @(inMOD)(inMOD.NIL.node_names);
    MOD.NIL.RefNodeName = @(inMOD)(inMOD.NIL.refnode_name);
    MOD.NIL.IOnodeNames = @(inMOD)(inMOD.NIL.io_nodenames);
    MOD.NIL.IOtypes = @(inMOD)(inMOD.NIL.io_types);
    MOD.OutputNames = @(inMOD)(inMOD.output_names);
    MOD.OutputMatrix = @OutputMatrix_ModSpec;
    MOD.nparms = @(inMOD)(length(inMOD.parm_names));
    MOD.parmnames = @(inMOD)(inMOD.parm_names);
    MOD.parmdefaults = @(inMOD)(inMOD.parm_defaultvals);
    MOD.getparms = @getparms_ModSpec;
    MOD.setparms = @setparms_ModSpec;
    MOD.getparmtypes = @getparmtypes_ModSpec;
    MOD.nparams = @(inMOD)(length(inMOD.parm_names));
    MOD.paramnames = @(inMOD)(inMOD.parm_names);
    MOD.paramdefaults = @(inMOD)(inMOD.parm_defaultvals);
    MOD.getparams = @getparms_ModSpec;
    MOD.setparams = @setparms_ModSpec;
    MOD.getparamtypes = @getparmtypes_ModSpec;
    MOD.LimitedVarNames = @(inMOD)(inMOD.limited_var_names);
    MOD.vecXYtoLimitedVarsMatrix = @vecXYtoLimitedVarsMatrix_ModSpec;
    MOD.vecXYtoLimitedVars = @vecXYtoLimitedVars_ModSpec;

    MOD = setup_IOnames_OtherIOnames_IOtypes_IOnodenames(MOD);

    MOD.fe = @fe_from_fqeiJ_ModSpec;
    MOD.qe = @qe_from_fqeiJ_ModSpec;
    MOD.fi = @fi_from_fqeiJ_ModSpec;
    MOD.qi = @qi_from_fqeiJ_ModSpec;
    MOD.fqei = @fqei_from_fqeiJ_ModSpec;
    MOD.fqeiJ = @fqeiJ;
    MOD.initGuess = @initGuess;
    MOD.limiting = @limiting;

    MOD.dfe_dvecX = @dfe_dvecX_from_fqeiJ_ModSpec;
    MOD.dfe_dvecY = @dfe_dvecY_from_fqeiJ_ModSpec;
    MOD.dfe_dvecLim = @dfe_dvecLim_from_fqeiJ_ModSpec;
    MOD.dfe_dvecU = @dfe_dvecU_from_fqeiJ_ModSpec;

    MOD.dqe_dvecX = @dqe_dvecX_from_fqeiJ_ModSpec;
    MOD.dqe_dvecY = @dqe_dvecY_from_fqeiJ_ModSpec;
    MOD.dqe_dvecLim = @dqe_dvecLim_from_fqeiJ_ModSpec;

    MOD.dfi_dvecX = @dfi_dvecX_from_fqeiJ_ModSpec;
    MOD.dfi_dvecY = @dfi_dvecY_from_fqeiJ_ModSpec;
    MOD.dfi_dvecLim = @dfi_dvecLim_from_fqeiJ_ModSpec;
    MOD.dfi_dvecU = @dfi_dvecU_from_fqeiJ_ModSpec;

    MOD.dqi_dvecX = @dqi_dvecX_from_fqeiJ_ModSpec;
    MOD.dqi_dvecY = @dqi_dvecY_from_fqeiJ_ModSpec;
    MOD.dqi_dvecLim = @dqi_dvecLim_from_fqeiJ_ModSpec;
    MOD.dinitGuess_dvecU = @dinitGuess_dvecU;
    MOD.dlimiting_dvecX = @dlimiting_dvecX;
    MOD.dlimiting_dvecY = @dlimiting_dvecY;

end


function [fqei_out, J_out] = fqeiJ(vecX, vecY, vecLim, vecU, flag, MOD)

    if nargin < 6

        MOD = flag;
        flag = vecU;
        vecU = vecLim;

    end

    do_fe = (isfield(flag, 'fe') && flag.fe == 1);
    do_qe = (isfield(flag, 'qe') && flag.qe == 1);
    do_fi = (isfield(flag, 'fi') && flag.fi == 1);
    do_qi = (isfield(flag, 'qi') && flag.qi == 1);
    do_J = (isfield(flag, 'J') && flag.J == 1);

    if nargin < 6

        if (do_fe && ~do_qe && ~do_fi && ~do_qi && ~do_J)

            fqei_out.fe = zeros(3, 1);
            J_out = zeros(0, 0);
            
            z1 = ((1.000000000000e-04/MOD.parm_vals{3})*MOD.parm_vals{10});
            
            fqei_out.fe(1, 1) = ((vecX(1)-vecY(1))/z1);
            fqei_out.fe(2, 1) = 0.000000000000e+00;
            fqei_out.fe(3, 1) = (-((vecY(2)-vecX(3))/z1));

        elseif (~do_fe && do_qe && ~do_fi && ~do_qi && ~do_J)

            % fqei_out.qe = zeros(3, 1);
            J_out = zeros(0, 0);
            
            z1 = MOD.parm_vals{3};
            z2 = (-z1);
            z3 = MOD.parm_vals{2};
            z4 = MOD.parm_vals{5};
            z5 = (MOD.parm_vals{4}-z4);
            z6 = (z3*z5);
            z7 = 1.000000000000e+00;
            z8 = vecX(2);
            z9 = vecY(2);
            z10 = (z8-z9);
            z11 = (z3*z10);
            z12 = vecY(1);
            z13 = (z8-z12);
            z14 = (z3*z13);
            z15 = (z11>=z14);
            z16 = ite(z15,z7,-1.000000000000e+00);
            z17 = (z7+z16);
            z18 = (MOD.parm_vals{23}==z7);
            z19 = ite(z15,z11,z14);
            z20 = MOD.parm_vals{20};
            z21 = MOD.parm_vals{19};
            z22 = MOD.parm_vals{18};
            z23 = (z3*(-z9));
            z24 = (z3*(-z12));
            z25 = ite(z15,z23,z24);
            z26 = sqrt(z22);
            z27 = (z20+(z21*(sqrt(abs((z22-z25)))-z26)));
            z28 = ite(z15,(z3*(z12-z9)),(z3*(z9-z12)));
            z29 = MOD.parm_vals{8};
            z30 = (z28*z29);
            z31 = (z27-z30);
            z32 = vecX(3);
            z33 = vecX(1);
            z34 = ((MOD.parm_vals{17}*1.380650300000e-23)/1.602191800000e-19);
            z35 = (MOD.parm_vals{21}*z34);
            z36 = (z7/(z7+exp(((ite(z15,(z3*(z8-z32)),(z3*(z8-z33)))-((z20+(z21*(sqrt(abs((z22-ite(z15,(z3*(-z32)),(z3*(-z33))))))-z26)))-z30))/(z35*1.500000000000e+00)))));
            z37 = ((MOD.parm_vals{9}+(MOD.parm_vals{25}*ite(z15,(z3*(z33-z32)),(z3*(z32-z33)))))*z34);
            z38 = ((z19-(z31-(z36*z35)))/z37);
            z39 = 4.000000000000e+01;
            z40 = (z38<=z39);
            z41 = MOD.parm_vals{6};
            z42 = (z41*z37);
            z43 = exp(z38);
            z44 = ite(z40,(z42*log((z7+z43))),(z42*z38));
            z45 = 6.000000000000e+00;
            z46 = 5.000000000000e-01;
            z47 = (z46*z35);
            z48 = (z7/(z7+exp(((z19-(z31-z47))/z35))));
            z49 = 0.000000000000e+00;
            z50 = (z21==z49);
            z51 = 2.000000000000e+00;
            z52 = (z7+log(log((1.000000000100e+00+z43))));
            z53 = (z7+log(z38));
            z54 = (((z7-z21)/(z7+z21))*z34);
            z55 = sqrt(abs((ite(z50,ite(z40,(z22+(z34*z52)),(z22+(z34*z53))),ite(z40,(z22+(z54*z52)),(z22+(z54*z53))))-z25)));
            z56 = ite(z50,z7,(z7+(z21/(z51*z55))));
            z57 = ((z44/z41)/z56);
            z58 = abs((z28/sqrt((((z48*z35)*z35)+(z57*z57)))));
            z59 = MOD.parm_vals{16};
            z60 = (z7/z59);
            z61 = (z58/((z7+(z58^z59))^z60));
            z62 = (z7-z61);
            z63 = (1.200000000000e+01*z62);
            z64 = (8.000000000000e+00*z62);
            z65 = 4.000000000000e+00;
            z66 = (z7+z62);
            z67 = ((1.500000000000e+01*z66)*z66);
            z68 = ((z44*(((z45+z63)+(z64*z62))+(((z65*z62)*z62)*z62)))/z67);
            z69 = (z7-(z61*z61));
            z70 = MOD.parm_vals{14};
            z71 = 1.000000000000e+02;
            z72 = ((1.000000000000e-10*z70)/z71);
            z73 = (9.100000000000e-31*MOD.parm_vals{22});
            z74 = 3.204383600000e-19;
            z75 = (z28<=(((z72*z72)*z73)/z74));
            z76 = ((z74/z73)*z28);
            z77 = ite(z75,z49,((sqrt(z76)/z70)*z71));
            z78 = ite(z75,((z76/(z70*z70))*1.000000000000e+04),(z77*z77));
            z79 = (z78*z78);
            z80 = ((sqrt((z78+z7))-z7)/z78);
            z81 = ite(z18,z68,((z68*z69)+((ite(z75,(z44*((z46-(z78/2.400000000000e+01))+(z79/8.000000000000e+01))),(z44*((asinh(z77)/z77)-z80)))*z61)*z61)));
            z82 = (z7-z16);
            z83 = ((z44*(((z65+z64)+(z63*z62))+(((z45*z62)*z62)*z62)))/z67);
            z84 = (z68+z83);
            z85 = ((z51*(z7-(9.900000000000e-01*z36)))*z34);
            z86 = (((z7+(z51*z29))*(z85/z51))*exp(((-z28)/z85)));
            z87 = (z7/(z7+exp((((z19+z86)-(((z20+(z21*(sqrt(abs((z22-(z25+z86))))-z26)))-z30)-z47))/z35))));
            z88 = ((z19-(z27-(z87*z35)))/z37);
            z89 = (ite(z18,z83,((z83*z69)+((ite(z75,(z44*((z46-(1.250000000000e-01*z78))+(z79/1.600000000000e+01))),(z44*z80))*z61)*z61)))-((((z7-z48)*z62)*z84)*(z44-ite((z88<=z39),(z42*log((z7+exp(z88)))),(z42*z88)))));
            z90 = ((((3.450000000000e-13/MOD.parm_vals{7})*z4)/z51)+MOD.parm_vals{13});
            z91 = MOD.parm_vals{12};
            z92 = MOD.parm_vals{24};
            z93 = abs((z28/((((z70*z5)/MOD.parm_vals{15})*(z7-z87))+(z34*z87))));
            z94 = (z30*(z93/((z7+(z93^z59))^z60)));
            z95 = (z35*z46);
            z96 = (1.100000000000e+00*z37);
            z97 = (((z11-((z20+(z21*(sqrt(abs((z22-z23)))-z26)))-z94))+z95)/z96);
            z98 = (z97<=z39);
            z99 = (((z14-((z20+(z21*(sqrt(abs((z22-z24)))-z26)))-z94))+z95)/z96);
            z100 = (z99<=z39);
            
            fqei_out.qe(2, 1) = (-(((z2*((((z6*((z17*z81)+(z82*z89)))/z51)+(z90*z10))+((z3*(z91+(z92*z11)))*ite(z98,(z11-(z37*log(ite(z98,(z7+exp(z97)),z49)))),(z11-(z37*z97))))))+(z2*((((z6*((z82*z81)+(z17*z89)))/z51)+(z90*z13))+((z3*(z91+(z92*z14)))*ite(z100,(z14-(z37*log(ite(z100,(z7+exp(z99)),z49)))),(z14-(z37*z99)))))))+((((-z3)*z1)*z5)*(((z41*z21)*z55)+((((z56-z7)/z56)*z44)*(z7-z84))))));
            fqei_out.qe(3, 1) = z49;
            fqei_out.qe(1, 1) = z49;
        
        elseif (~do_fe && ~do_qe && do_fi && ~do_qi && ~do_J)

            % fqei_out.fi = zeros(2, 1);
            J_out = zeros(0, 0);
            
            z1 = vecY(2);
            z2 = vecX(3);
            z3 = MOD.parm_vals{3};
            z4 = ((1.000000000000e-04/z3)*MOD.parm_vals{10});
            z5 = MOD.parm_vals{2};
            z6 = vecX(2);
            z7 = (z5*(z6-z1));
            z8 = vecY(1);
            z9 = (z5*(z6-z8));
            z10 = (z7>=z9);
            z11 = 1.000000000000e+00;
            z12 = 2.000000000000e+00;
            z13 = MOD.parm_vals{8};
            z14 = vecX(1);
            z15 = MOD.parm_vals{20};
            z16 = MOD.parm_vals{19};
            z17 = MOD.parm_vals{18};
            z18 = sqrt(z17);
            z19 = (z8-z1);
            z20 = ite(z10,(z5*z19),(z5*(z1-z8)));
            z21 = (z20*z13);
            z22 = ((MOD.parm_vals{17}*1.380650300000e-23)/1.602191800000e-19);
            z23 = (MOD.parm_vals{21}*z22);
            z24 = ((z12*(z11-(9.900000000000e-01*(z11/(z11+exp(((ite(z10,(z5*(z6-z2)),(z5*(z6-z14)))-((z15+(z16*(sqrt(abs((z17-ite(z10,(z5*(-z2)),(z5*(-z14))))))-z18)))-z21))/(z23*1.500000000000e+00))))))))*z22);
            z25 = (((z11+(z12*z13))*(z24/z12))*exp(((-z20)/z24)));
            z26 = (ite(z10,z7,z9)+z25);
            z27 = ((z15+(z16*(sqrt(abs((z17-(ite(z10,(z5*(-z1)),(z5*(-z8)))+z25))))-z18)))-z21);
            z28 = (z11/(z11+exp(((z26-(z27-(5.000000000000e-01*z23)))/z23))));
            z29 = ((MOD.parm_vals{9}+(MOD.parm_vals{25}*ite(z10,(z5*(z14-z2)),(z5*(z2-z14)))))*z22);
            z30 = ((z26-(z27-(z28*z23)))/z29);
            z31 = (MOD.parm_vals{6}*z29);
            z32 = MOD.parm_vals{14};
            z33 = abs((z20/((((z32*(MOD.parm_vals{4}-MOD.parm_vals{5}))/MOD.parm_vals{15})*(z11-z28))+(z22*z28))));
            z34 = MOD.parm_vals{16};
            z35 = (((z5*ite(z10,z11,-1.000000000000e+00))*(((ite((z30<=4.000000000000e+01),(z31*log((z11+exp(z30)))),(z31*z30))*z32)*(z33/((z11+(z33^z34))^(z11/z34))))*z3))+(z19*MOD.parm_vals{26}));
            
            fqei_out.fi(2, 1) = (((z1-z2)/z4)-z35);
            fqei_out.fi(1, 1) = (z35-((z14-z8)/z4));

        elseif (~do_fe && ~do_qe && ~do_fi && do_qi && ~do_J)

            % fqei_out.qi = zeros(2, 1);
            J_out = zeros(0, 0);
            
            z1 = (-MOD.parm_vals{3});
            z2 = MOD.parm_vals{2};
            z3 = MOD.parm_vals{5};
            z4 = (MOD.parm_vals{4}-z3);
            z5 = (z2*z4);
            z6 = 1.000000000000e+00;
            z7 = vecX(2);
            z8 = vecY(2);
            z9 = (z7-z8);
            z10 = (z2*z9);
            z11 = vecY(1);
            z12 = (z7-z11);
            z13 = (z2*z12);
            z14 = (z10>=z13);
            z15 = ite(z14,z6,-1.000000000000e+00);
            z16 = (z6-z15);
            z17 = (MOD.parm_vals{23}==z6);
            z18 = ite(z14,z10,z13);
            z19 = MOD.parm_vals{20};
            z20 = MOD.parm_vals{19};
            z21 = MOD.parm_vals{18};
            z22 = (z2*(-z8));
            z23 = (z2*(-z11));
            z24 = ite(z14,z22,z23);
            z25 = sqrt(z21);
            z26 = (z19+(z20*(sqrt(abs((z21-z24)))-z25)));
            z27 = ite(z14,(z2*(z11-z8)),(z2*(z8-z11)));
            z28 = MOD.parm_vals{8};
            z29 = (z27*z28);
            z30 = (z26-z29);
            z31 = vecX(3);
            z32 = vecX(1);
            z33 = ((MOD.parm_vals{17}*1.380650300000e-23)/1.602191800000e-19);
            z34 = (MOD.parm_vals{21}*z33);
            z35 = (z6/(z6+exp(((ite(z14,(z2*(z7-z31)),(z2*(z7-z32)))-((z19+(z20*(sqrt(abs((z21-ite(z14,(z2*(-z31)),(z2*(-z32))))))-z25)))-z29))/(z34*1.500000000000e+00)))));
            z36 = ((MOD.parm_vals{9}+(MOD.parm_vals{25}*ite(z14,(z2*(z32-z31)),(z2*(z31-z32)))))*z33);
            z37 = ((z18-(z30-(z35*z34)))/z36);
            z38 = 4.000000000000e+01;
            z39 = (z37<=z38);
            z40 = MOD.parm_vals{6};
            z41 = (z40*z36);
            z42 = exp(z37);
            z43 = ite(z39,(z41*log((z6+z42))),(z41*z37));
            z44 = 6.000000000000e+00;
            z45 = 5.000000000000e-01;
            z46 = (z45*z34);
            z47 = (z6/(z6+exp(((z18-(z30-z46))/z34))));
            z48 = 0.000000000000e+00;
            z49 = (z20==z48);
            z50 = 2.000000000000e+00;
            z51 = (z6+log(log((1.000000000100e+00+z42))));
            z52 = (z6+log(z37));
            z53 = (((z6-z20)/(z6+z20))*z33);
            z54 = ((z43/z40)/ite(z49,z6,(z6+(z20/(z50*sqrt(abs((ite(z49,ite(z39,(z21+(z33*z51)),(z21+(z33*z52))),ite(z39,(z21+(z53*z51)),(z21+(z53*z52))))-z24))))))));
            z55 = abs((z27/sqrt((((z47*z34)*z34)+(z54*z54)))));
            z56 = MOD.parm_vals{16};
            z57 = (z6/z56);
            z58 = (z55/((z6+(z55^z56))^z57));
            z59 = (z6-z58);
            z60 = (1.200000000000e+01*z59);
            z61 = (8.000000000000e+00*z59);
            z62 = 4.000000000000e+00;
            z63 = (z6+z59);
            z64 = ((1.500000000000e+01*z63)*z63);
            z65 = ((z43*(((z44+z60)+(z61*z59))+(((z62*z59)*z59)*z59)))/z64);
            z66 = (z6-(z58*z58));
            z67 = MOD.parm_vals{14};
            z68 = 1.000000000000e+02;
            z69 = ((1.000000000000e-10*z67)/z68);
            z70 = (9.100000000000e-31*MOD.parm_vals{22});
            z71 = 3.204383600000e-19;
            z72 = (z27<=(((z69*z69)*z70)/z71));
            z73 = ((z71/z70)*z27);
            z74 = ite(z72,z48,((sqrt(z73)/z67)*z68));
            z75 = ite(z72,((z73/(z67*z67))*1.000000000000e+04),(z74*z74));
            z76 = (z75*z75);
            z77 = ((sqrt((z75+z6))-z6)/z75);
            z78 = ite(z17,z65,((z65*z66)+((ite(z72,(z43*((z45-(z75/2.400000000000e+01))+(z76/8.000000000000e+01))),(z43*((asinh(z74)/z74)-z77)))*z58)*z58)));
            z79 = (z6+z15);
            z80 = ((z43*(((z62+z61)+(z60*z59))+(((z44*z59)*z59)*z59)))/z64);
            z81 = ((z50*(z6-(9.900000000000e-01*z35)))*z33);
            z82 = (((z6+(z50*z28))*(z81/z50))*exp(((-z27)/z81)));
            z83 = (z6/(z6+exp((((z18+z82)-(((z19+(z20*(sqrt(abs((z21-(z24+z82))))-z25)))-z29)-z46))/z34))));
            z84 = ((z18-(z26-(z83*z34)))/z36);
            z85 = (ite(z17,z80,((z80*z66)+((ite(z72,(z43*((z45-(1.250000000000e-01*z75))+(z76/1.600000000000e+01))),(z43*z77))*z58)*z58)))-((((z6-z47)*z59)*(z65+z80))*(z43-ite((z84<=z38),(z41*log((z6+exp(z84)))),(z41*z84)))));
            z86 = ((((3.450000000000e-13/MOD.parm_vals{7})*z3)/z50)+MOD.parm_vals{13});
            z87 = MOD.parm_vals{12};
            z88 = MOD.parm_vals{24};
            z89 = abs((z27/((((z67*z4)/MOD.parm_vals{15})*(z6-z83))+(z33*z83))));
            z90 = (z29*(z89/((z6+(z89^z56))^z57)));
            z91 = (z34*z45);
            z92 = (1.100000000000e+00*z36);
            z93 = (((z13-((z19+(z20*(sqrt(abs((z21-z23)))-z25)))-z90))+z91)/z92);
            z94 = (z93<=z38);
            z95 = (((z10-((z19+(z20*(sqrt(abs((z21-z22)))-z25)))-z90))+z91)/z92);
            z96 = (z95<=z38);
            
            fqei_out.qi(1, 1) = (z1*((((z5*((z16*z78)+(z79*z85)))/z50)+(z86*z12))+((z2*(z87+(z88*z13)))*ite(z94,(z13-(z36*log(ite(z94,(z6+exp(z93)),z48)))),(z13-(z36*z93))))));
            fqei_out.qi(2, 1) = (z1*((((z5*((z79*z78)+(z16*z85)))/z50)+(z86*z9))+((z2*(z87+(z88*z10)))*ite(z96,(z10-(z36*log(ite(z96,(z6+exp(z95)),z48)))),(z10-(z36*z95))))));

        else

            % fqei_out.fe = zeros(3, 1);
            % fqei_out.qe = zeros(3, 1);
            % fqei_out.fi = zeros(2, 1);
            % fqei_out.qi = zeros(2, 1);
            J_out.Jfe.dfe_dvecX = zeros(3, 3);
            J_out.Jfe.dfe_dvecY = zeros(3, 2);
            J_out.Jfe.dfe_dvecU = zeros(3, 0);
            J_out.Jqe.dqe_dvecX = zeros(3, 3);
            J_out.Jqe.dqe_dvecY = zeros(3, 2);
            J_out.Jfi.dfi_dvecX = zeros(2, 3);
            J_out.Jfi.dfi_dvecY = zeros(2, 2);
            J_out.Jfi.dfi_dvecU = zeros(2, 0);
            J_out.Jqi.dqi_dvecX = zeros(2, 3);
            J_out.Jqi.dqi_dvecY = zeros(2, 2);
            
            z1 = MOD.parm_vals{3};
            z2 = (-z1);
            z3 = MOD.parm_vals{2};
            z4 = MOD.parm_vals{5};
            z5 = (MOD.parm_vals{4}-z4);
            z6 = (z3*z5);
            z7 = 1.000000000000e+00;
            z8 = vecX(2);
            z9 = vecY(2);
            z10 = (z8-z9);
            z11 = (z3*z10);
            z12 = vecY(1);
            z13 = (z8-z12);
            z14 = (z3*z13);
            z15 = (z11>=z14);
            z16 = -1.000000000000e+00;
            z17 = ite(z15,z7,z16);
            z18 = (z7+z17);
            z19 = (MOD.parm_vals{23}==z7);
            z20 = 1.500000000000e+01;
            z21 = (z12-z9);
            z22 = ite(z15,(z3*z21),(z3*(z9-z12)));
            z23 = ite(z15,z11,z14);
            z24 = MOD.parm_vals{20};
            z25 = MOD.parm_vals{19};
            z26 = MOD.parm_vals{18};
            z27 = (z3*(-z9));
            z28 = (z3*(-z12));
            z29 = ite(z15,z27,z28);
            z30 = (z26-z29);
            z31 = sqrt(abs(z30));
            z32 = sqrt(z26);
            z33 = (z24+(z25*(z31-z32)));
            z34 = MOD.parm_vals{8};
            z35 = (z22*z34);
            z36 = (z33-z35);
            z37 = 5.000000000000e-01;
            z38 = ((MOD.parm_vals{17}*1.380650300000e-23)/1.602191800000e-19);
            z39 = (MOD.parm_vals{21}*z38);
            z40 = (z37*z39);
            z41 = exp(((z23-(z36-z40))/z39));
            z42 = (z7+z41);
            z43 = (z7/z42);
            z44 = vecX(3);
            z45 = vecX(1);
            z46 = (z26-ite(z15,(z3*(-z44)),(z3*(-z45))));
            z47 = sqrt(abs(z46));
            z48 = (z39*1.500000000000e+00);
            z49 = exp(((ite(z15,(z3*(z8-z44)),(z3*(z8-z45)))-((z24+(z25*(z47-z32)))-z35))/z48));
            z50 = (z7+z49);
            z51 = (z7/z50);
            z52 = (z23-(z36-(z51*z39)));
            z53 = MOD.parm_vals{25};
            z54 = ((MOD.parm_vals{9}+(z53*ite(z15,(z3*(z45-z44)),(z3*(z44-z45)))))*z38);
            z55 = (z52/z54);
            z56 = 4.000000000000e+01;
            z57 = (z55<=z56);
            z58 = MOD.parm_vals{6};
            z59 = (z58*z54);
            z60 = exp(z55);
            z61 = (z7+z60);
            z62 = log(z61);
            z63 = ite(z57,(z59*z62),(z59*z55));
            z64 = (z63/z58);
            z65 = 0.000000000000e+00;
            z66 = (z25==z65);
            z67 = 2.000000000000e+00;
            z68 = (1.000000000100e+00+z60);
            z69 = log(z68);
            z70 = (z7+log(z69));
            z71 = (z7+log(z55));
            z72 = (((z7-z25)/(z7+z25))*z38);
            z73 = (ite(z66,ite(z57,(z26+(z38*z70)),(z26+(z38*z71))),ite(z57,(z26+(z72*z70)),(z26+(z72*z71))))-z29);
            z74 = sqrt(abs(z73));
            z75 = (z67*z74);
            z76 = ite(z66,z7,(z7+(z25/z75)));
            z77 = (z64/z76);
            z78 = sqrt((((z43*z39)*z39)+(z77*z77)));
            z79 = (z22/z78);
            z80 = abs(z79);
            z81 = MOD.parm_vals{16};
            z82 = (z7+(z80^z81));
            z83 = (z7/z81);
            z84 = (z82^z83);
            z85 = (z80/z84);
            z86 = (z7-z85);
            z87 = (z7+z86);
            z88 = (z20*z87);
            z89 = (z88*z87);
            z90 = 1.200000000000e+01;
            z91 = ite((z79>z65),z7,z16);
            z92 = (z78^z67);
            z93 = (z22*(z16/z92));
            z94 = (z7/(z67*z78));
            z95 = (z7/z61);
            z96 = (z16/(z50^z67));
            z97 = (z3*z16);
            z98 = ite(z15,z97,z65);
            z99 = (z7/(z67*z47));
            z100 = ite((z46>z65),z7,z16);
            z101 = (-z98);
            z102 = (z96*(z49*((z98-(z25*(z99*(z100*z101))))/z48)));
            z103 = ite(z15,z97,z3);
            z104 = (z38*(z53*z103));
            z105 = (z54^z67);
            z106 = (((z54*(-(-(z39*z102))))-(z52*z104))/z105);
            z107 = (z60*z106);
            z108 = (z58*z104);
            z109 = ite(z57,((z59*(z95*z107))+(z62*z108)),((z59*z106)+(z55*z108)));
            z110 = (z25*(z16/(z75^z67)));
            z111 = (z7/z75);
            z112 = ite((z73>z65),z7,z16);
            z113 = (z7/z69);
            z114 = (z7/z68);
            z115 = (z113*(z114*z107));
            z116 = (z7/z55);
            z117 = (z116*z106);
            z118 = (z111*(z112*ite(z66,ite(z57,(z38*z115),(z38*z117)),ite(z57,(z72*z115),(z72*z117)))));
            z119 = ite(z66,z65,(z110*(z67*z118)));
            z120 = (z76^z67);
            z121 = (z77*(((z76*(z109/z58))-(z64*z119))/z120));
            z122 = (z91*(z93*(z94*(z121+z121))));
            z123 = (z83-z7);
            z124 = (z83*(z82^z123));
            z125 = (z81-z7);
            z126 = (z81*(z80^z125));
            z127 = (z84^z67);
            z128 = (((z84*z122)-(z80*(z124*(z126*z122))))/z127);
            z129 = (-z128);
            z130 = (z90*z129);
            z131 = 8.000000000000e+00;
            z132 = (z131*z86);
            z133 = (z131*z129);
            z134 = 4.000000000000e+00;
            z135 = (z134*z86);
            z136 = (z135*z86);
            z137 = 6.000000000000e+00;
            z138 = (z90*z86);
            z139 = (((z137+z138)+(z132*z86))+(z136*z86));
            z140 = (z63*z139);
            z141 = ((z88*z129)+(z87*(z20*z129)));
            z142 = (z89^z67);
            z143 = (((z89*((z63*((z130+((z132*z129)+(z86*z133)))+((z136*z129)+(z86*((z135*z129)+(z86*(z134*z129)))))))+(z139*z109)))-(z140*z141))/z142);
            z144 = (z140/z89);
            z145 = (z85*z128);
            z146 = (-(z145+z145));
            z147 = (z7-(z85*z85));
            z148 = MOD.parm_vals{14};
            z149 = 1.000000000000e+02;
            z150 = ((1.000000000000e-10*z148)/z149);
            z151 = (9.100000000000e-31*MOD.parm_vals{22});
            z152 = 3.204383600000e-19;
            z153 = (z22<=(((z150*z150)*z151)/z152));
            z154 = (z152/z151);
            z155 = (z154*z22);
            z156 = (z148*z148);
            z157 = 1.000000000000e+04;
            z158 = sqrt(z155);
            z159 = ite(z153,z65,((z158/z148)*z149));
            z160 = ite(z153,((z155/z156)*z157),(z159*z159));
            z161 = 2.400000000000e+01;
            z162 = (z160*z160);
            z163 = 8.000000000000e+01;
            z164 = ((z37-(z160/z161))+(z162/z163));
            z165 = asinh(z159);
            z166 = sqrt((z160+z7));
            z167 = (z166-z7);
            z168 = (z167/z160);
            z169 = ((z165/z159)-z168);
            z170 = ite(z153,(z63*z164),(z63*z169));
            z171 = (z170*z85);
            z172 = ite(z19,z143,(((z144*z146)+(z147*z143))+((z171*z128)+(z85*((z170*z128)+(z85*ite(z153,(z164*z109),(z169*z109))))))));
            z173 = (z7-z17);
            z174 = (z137*z86);
            z175 = (z174*z86);
            z176 = (((z134+z132)+(z138*z86))+(z175*z86));
            z177 = (z63*z176);
            z178 = (((z89*((z63*((z133+((z138*z129)+(z86*z130)))+((z175*z129)+(z86*((z174*z129)+(z86*(z137*z129)))))))+(z176*z109)))-(z177*z141))/z142);
            z179 = (z177/z89);
            z180 = 1.250000000000e-01;
            z181 = 1.600000000000e+01;
            z182 = ((z37-(z180*z160))+(z162/z181));
            z183 = ite(z153,(z63*z182),(z63*z168));
            z184 = (z183*z85);
            z185 = (z7-z43);
            z186 = (z185*z86);
            z187 = (z144+z179);
            z188 = (z186*z187);
            z189 = (z7+(z67*z34));
            z190 = 9.900000000000e-01;
            z191 = ((z67*(z7-(z190*z51)))*z38);
            z192 = (z189*(z191/z67));
            z193 = (-z22);
            z194 = exp((z193/z191));
            z195 = (z192*z194);
            z196 = (z23+z195);
            z197 = (z26-(z29+z195));
            z198 = sqrt(abs(z197));
            z199 = ((z24+(z25*(z198-z32)))-z35);
            z200 = exp(((z196-(z199-z40))/z39));
            z201 = (z7+z200);
            z202 = (z7/z201);
            z203 = (z202*z39);
            z204 = (z23-(z33-z203));
            z205 = (z204/z54);
            z206 = (z205<=z56);
            z207 = exp(z205);
            z208 = (z7+z207);
            z209 = (z7/z208);
            z210 = (z16/(z201^z67));
            z211 = (z191^z67);
            z212 = (z193*(z16/z211));
            z213 = (z38*(z67*(-(z190*z102))));
            z214 = ((z192*(z194*(z212*z213)))+(z194*(z189*(z213/z67))));
            z215 = (z7/(z67*z198));
            z216 = ite((z197>z65),z7,z16);
            z217 = (z25*(z215*(z216*(-z214))));
            z218 = (z210*(z200*((z214-z217)/z39)));
            z219 = (z39*z218);
            z220 = (((z54*(-(-z219)))-(z204*z104))/z105);
            z221 = log(z208);
            z222 = (z63-ite(z206,(z59*z221),(z59*z205)));
            z223 = (z143+z178);
            z224 = (ite(z19,z178,(((z179*z146)+(z147*z178))+((z184*z128)+(z85*((z183*z128)+(z85*ite(z153,(z182*z109),(z168*z109))))))))-((z188*(z109-ite(z206,((z59*(z209*(z207*z220)))+(z221*z108)),((z59*z220)+(z205*z108)))))+(z222*((z186*z223)+(z187*(z185*z129))))));
            z225 = MOD.parm_vals{12};
            z226 = MOD.parm_vals{24};
            z227 = (z3*(z225+(z226*z11)));
            z228 = (z26-z27);
            z229 = sqrt(abs(z228));
            z230 = ((z148*z5)/MOD.parm_vals{15});
            z231 = ((z230*(z7-z202))+(z38*z202));
            z232 = (z22/z231);
            z233 = abs(z232);
            z234 = (z7+(z233^z81));
            z235 = (z234^z83);
            z236 = (z233/z235);
            z237 = (z35*z236);
            z238 = (z39*z37);
            z239 = ((z11-((z24+(z25*(z229-z32)))-z237))+z238);
            z240 = 1.100000000000e+00;
            z241 = (z240*z54);
            z242 = (z239/z241);
            z243 = (z242<=z56);
            z244 = exp(z242);
            z245 = ite(z243,(z7+z244),z65);
            z246 = (z7/z245);
            z247 = ite((z232>z65),z7,z16);
            z248 = (z231^z67);
            z249 = (z22*(z16/z248));
            z250 = (z247*(z249*((z230*(-z218))+(z38*z218))));
            z251 = (z83*(z234^z123));
            z252 = (z81*(z233^z125));
            z253 = (z235^z67);
            z254 = (((z235*z250)-(z233*(z251*(z252*z250))))/z253);
            z255 = (z241*(-(-(z35*z254))));
            z256 = (z240*z104);
            z257 = (z241^z67);
            z258 = ((z255-(z239*z256))/z257);
            z259 = log(z245);
            z260 = (z2*(((z6*((z18*z172)+(z173*z224)))/z67)+(z227*ite(z243,(-((z54*(z246*ite(z243,(z244*z258),z65)))+(z259*z104))),(-((z54*z258)+(z242*z104)))))));
            z261 = ite(z19,z144,((z144*z147)+(z171*z85)));
            z262 = (ite(z19,z179,((z179*z147)+(z184*z85)))-(z188*z222));
            z263 = ((((3.450000000000e-13/MOD.parm_vals{7})*z4)/z67)+MOD.parm_vals{13});
            z264 = (z3*(z225+(z226*z14)));
            z265 = (z26-z28);
            z266 = sqrt(abs(z265));
            z267 = ((z14-((z24+(z25*(z266-z32)))-z237))+z238);
            z268 = (z267/z241);
            z269 = (z268<=z56);
            z270 = exp(z268);
            z271 = ite(z269,(z7+z270),z65);
            z272 = log(z271);
            z273 = ite(z269,(z14-(z54*z272)),(z14-(z54*z268)));
            z274 = (z2*((((z6*((z173*z261)+(z18*z262)))/z67)+(z263*z13))+(z264*z273)));
            z275 = ite(z15,z3,z97);
            z276 = (z16/(z42^z67));
            z277 = ite(z15,z65,z97);
            z278 = (z7/(z67*z31));
            z279 = ite((z30>z65),z7,z16);
            z280 = (-z277);
            z281 = (z25*(z278*(z279*z280)));
            z282 = (z34*z275);
            z283 = (z281-z282);
            z284 = (z276*(z41*((z277-z283)/z39)));
            z285 = (z96*(z49*((-(-z282))/z48)));
            z286 = ((z277-(z283-(z39*z285)))/z54);
            z287 = (z60*z286);
            z288 = ite(z57,(z59*(z95*z287)),(z59*z286));
            z289 = (z113*(z114*z287));
            z290 = (z116*z286);
            z291 = (z111*(z112*(ite(z66,ite(z57,(z38*z289),(z38*z290)),ite(z57,(z72*z289),(z72*z290)))-z277)));
            z292 = ite(z66,z65,(z110*(z67*z291)));
            z293 = (z77*(((z76*(z288/z58))-(z64*z292))/z120));
            z294 = (z91*(((z78*z275)-(z22*(z94*((z39*(z39*z284))+(z293+z293)))))/z92));
            z295 = (((z84*z294)-(z80*(z124*(z126*z294))))/z127);
            z296 = (-z295);
            z297 = (z90*z296);
            z298 = (z131*z296);
            z299 = ((z88*z296)+(z87*(z20*z296)));
            z300 = (((z89*((z63*((z297+((z132*z296)+(z86*z298)))+((z136*z296)+(z86*((z135*z296)+(z86*(z134*z296)))))))+(z139*z288)))-(z140*z299))/z142);
            z301 = (z85*z295);
            z302 = (-(z301+z301));
            z303 = (z154*z275);
            z304 = (z7/(z67*z158));
            z305 = ite(z153,z65,(z149*((z304*z303)/z148)));
            z306 = (z159*z305);
            z307 = ite(z153,(z157*(z303/z156)),(z306+z306));
            z308 = (z160*z307);
            z309 = (z308+z308);
            z310 = (z159^z67);
            z311 = (z7/sqrt((z7+z310)));
            z312 = (z7/(z67*z166));
            z313 = (z160^z67);
            z314 = (((z160*(z312*z307))-(z167*z307))/z313);
            z315 = ite(z19,z300,(((z144*z302)+(z147*z300))+((z171*z295)+(z85*((z170*z295)+(z85*ite(z153,((z63*((-(z307/z161))+(z309/z163)))+(z164*z288)),((z63*((((z159*(z311*z305))-(z165*z305))/z310)-z314))+(z169*z288)))))))));
            z316 = (((z89*((z63*((z298+((z138*z296)+(z86*z297)))+((z175*z296)+(z86*((z174*z296)+(z86*(z137*z296)))))))+(z176*z288)))-(z177*z299))/z142);
            z317 = (z38*(z67*(-(z190*z285))));
            z318 = (z277+((z192*(z194*(((z191*(z16*z275))-(z193*z317))/z211)))+(z194*(z189*(z317/z67)))));
            z319 = ((z25*(z215*(z216*(-z318))))-z282);
            z320 = (z210*(z200*((z318-z319)/z39)));
            z321 = (z39*z320);
            z322 = ((z277-(z281-z321))/z54);
            z323 = (z300+z316);
            z324 = (ite(z19,z316,(((z179*z302)+(z147*z316))+((z184*z295)+(z85*((z183*z295)+(z85*ite(z153,((z63*((-(z180*z307))+(z309/z181)))+(z182*z288)),((z63*z314)+(z168*z288)))))))))-((z188*(z288-ite(z206,(z59*(z209*(z207*z322))),(z59*z322))))+(z222*((z186*z323)+(z187*((z185*z296)+(z86*(-z284))))))));
            z325 = (z247*(((z231*z275)-(z22*((z230*(-z320))+(z38*z320))))/z248));
            z326 = (((z235*z325)-(z233*(z251*(z252*z325))))/z253);
            z327 = ((z35*z326)+(z236*z282));
            z328 = ((-(-z327))/z241);
            z329 = (z2*(((z6*((z18*z315)+(z173*z324)))/z67)+(z227*ite(z243,(-(z54*(z246*ite(z243,(z244*z328),z65)))),(-(z54*z328))))));
            z330 = (z25*(z278*(z279*z101)));
            z331 = (z34*z103);
            z332 = (z330-z331);
            z333 = (z276*(z41*((z98-z332)/z39)));
            z334 = (z96*(z49*((-(-z331))/z48)));
            z335 = ((z98-(z332-(z39*z334)))/z54);
            z336 = (z60*z335);
            z337 = ite(z57,(z59*(z95*z336)),(z59*z335));
            z338 = (z113*(z114*z336));
            z339 = (z116*z335);
            z340 = (z111*(z112*(ite(z66,ite(z57,(z38*z338),(z38*z339)),ite(z57,(z72*z338),(z72*z339)))-z98)));
            z341 = ite(z66,z65,(z110*(z67*z340)));
            z342 = (z77*(((z76*(z337/z58))-(z64*z341))/z120));
            z343 = (z91*(((z78*z103)-(z22*(z94*((z39*(z39*z333))+(z342+z342)))))/z92));
            z344 = (((z84*z343)-(z80*(z124*(z126*z343))))/z127);
            z345 = (-z344);
            z346 = (z90*z345);
            z347 = (z131*z345);
            z348 = ((z88*z345)+(z87*(z20*z345)));
            z349 = (((z89*((z63*((z346+((z132*z345)+(z86*z347)))+((z136*z345)+(z86*((z135*z345)+(z86*(z134*z345)))))))+(z139*z337)))-(z140*z348))/z142);
            z350 = (z85*z344);
            z351 = (-(z350+z350));
            z352 = (z154*z103);
            z353 = ite(z153,z65,(z149*((z304*z352)/z148)));
            z354 = (z159*z353);
            z355 = ite(z153,(z157*(z352/z156)),(z354+z354));
            z356 = (z160*z355);
            z357 = (z356+z356);
            z358 = (((z160*(z312*z355))-(z167*z355))/z313);
            z359 = ite(z19,z349,(((z144*z351)+(z147*z349))+((z171*z344)+(z85*((z170*z344)+(z85*ite(z153,((z63*((-(z355/z161))+(z357/z163)))+(z164*z337)),((z63*((((z159*(z311*z353))-(z165*z353))/z310)-z358))+(z169*z337)))))))));
            z360 = (((z89*((z63*((z347+((z138*z345)+(z86*z346)))+((z175*z345)+(z86*((z174*z345)+(z86*(z137*z345)))))))+(z176*z337)))-(z177*z348))/z142);
            z361 = (z38*(z67*(-(z190*z334))));
            z362 = (z98+((z192*(z194*(((z191*(z16*z103))-(z193*z361))/z211)))+(z194*(z189*(z361/z67)))));
            z363 = ((z25*(z215*(z216*(-z362))))-z331);
            z364 = (z210*(z200*((z362-z363)/z39)));
            z365 = (z39*z364);
            z366 = ((z98-(z330-z365))/z54);
            z367 = (z349+z360);
            z368 = (ite(z19,z360,(((z179*z351)+(z147*z360))+((z184*z344)+(z85*((z183*z344)+(z85*ite(z153,((z63*((-(z180*z355))+(z357/z181)))+(z182*z337)),((z63*z358)+(z168*z337)))))))))-((z188*(z337-ite(z206,(z59*(z209*(z207*z366))),(z59*z366))))+(z222*((z186*z367)+(z187*((z185*z345)+(z86*(-z333))))))));
            z369 = (z263*z16);
            z370 = (-z97);
            z371 = (z247*(((z231*z103)-(z22*((z230*(-z364))+(z38*z364))))/z248));
            z372 = (((z235*z371)-(z233*(z251*(z252*z371))))/z253);
            z373 = ((z35*z372)+(z236*z331));
            z374 = ((z97-((z25*((z7/(z67*z229))*(ite((z228>z65),z7,z16)*z370)))-z373))/z241);
            z375 = ite(z243,(z11-(z54*z259)),(z11-(z54*z242)));
            z376 = (z3*(z226*z97));
            z377 = (z2*((((z6*((z18*z359)+(z173*z368)))/z67)+z369)+((z227*ite(z243,(z97-(z54*(z246*ite(z243,(z244*z374),z65)))),(z97-(z54*z374))))+(z375*z376))));
            z378 = ((1.000000000000e-04/z1)*MOD.parm_vals{10});
            z379 = ((z45-z12)/z378);
            z380 = (z3*z17);
            z381 = (z196-(z199-z203));
            z382 = (z381/z54);
            z383 = (z382<=z56);
            z384 = exp(z382);
            z385 = (z7+z384);
            z386 = log(z385);
            z387 = (ite(z383,(z59*z386),(z59*z382))*z148);
            z388 = (z96*(z49*(z3/z48)));
            z389 = (z38*(z67*(-(z190*z388))));
            z390 = ((z192*(z194*(z212*z389)))+(z194*(z189*(z389/z67))));
            z391 = (z3+z390);
            z392 = (z25*(z215*(z216*(-z390))));
            z393 = (z210*(z200*((z391-z392)/z39)));
            z394 = (z247*(z249*((z230*(-z393))+(z38*z393))));
            z395 = (((z235*z394)-(z233*(z251*(z252*z394))))/z253);
            z396 = (z7/z385);
            z397 = (z39*z393);
            z398 = ((z391-(z392-z397))/z54);
            z399 = (z380*(z1*((z387*z395)+(z236*(z148*ite(z383,(z59*(z396*(z384*z398))),(z59*z398)))))));
            z400 = (z7/z378);
            z401 = ((z9-z44)/z378);
            z402 = (((z54*(z214-(z217-z219)))-(z381*z104))/z105);
            z403 = (z380*(z1*((z387*z254)+(z236*(z148*ite(z383,((z59*(z396*(z384*z402)))+(z386*z108)),((z59*z402)+(z382*z108))))))));
            z404 = (z96*(z49*((z277-(z25*(z99*(z100*z280))))/z48)));
            z405 = (z38*(z53*z275));
            z406 = (((z54*(-(-(z39*z404))))-(z52*z405))/z105);
            z407 = (z60*z406);
            z408 = (z58*z405);
            z409 = ite(z57,((z59*(z95*z407))+(z62*z408)),((z59*z406)+(z55*z408)));
            z410 = (z113*(z114*z407));
            z411 = (z116*z406);
            z412 = (z111*(z112*ite(z66,ite(z57,(z38*z410),(z38*z411)),ite(z57,(z72*z410),(z72*z411)))));
            z413 = ite(z66,z65,(z110*(z67*z412)));
            z414 = (z77*(((z76*(z409/z58))-(z64*z413))/z120));
            z415 = (z91*(z93*(z94*(z414+z414))));
            z416 = (((z84*z415)-(z80*(z124*(z126*z415))))/z127);
            z417 = (-z416);
            z418 = (z90*z417);
            z419 = (z131*z417);
            z420 = ((z88*z417)+(z87*(z20*z417)));
            z421 = (((z89*((z63*((z418+((z132*z417)+(z86*z419)))+((z136*z417)+(z86*((z135*z417)+(z86*(z134*z417)))))))+(z139*z409)))-(z140*z420))/z142);
            z422 = (z85*z416);
            z423 = (-(z422+z422));
            z424 = ite(z19,z421,(((z144*z423)+(z147*z421))+((z171*z416)+(z85*((z170*z416)+(z85*ite(z153,(z164*z409),(z169*z409))))))));
            z425 = (((z89*((z63*((z419+((z138*z417)+(z86*z418)))+((z175*z417)+(z86*((z174*z417)+(z86*(z137*z417)))))))+(z176*z409)))-(z177*z420))/z142);
            z426 = (z38*(z67*(-(z190*z404))));
            z427 = ((z192*(z194*(z212*z426)))+(z194*(z189*(z426/z67))));
            z428 = (z25*(z215*(z216*(-z427))));
            z429 = (z210*(z200*((z427-z428)/z39)));
            z430 = (z39*z429);
            z431 = (((z54*(-(-z430)))-(z204*z405))/z105);
            z432 = (z421+z425);
            z433 = (ite(z19,z425,(((z179*z423)+(z147*z425))+((z184*z416)+(z85*((z183*z416)+(z85*ite(z153,(z182*z409),(z168*z409))))))))-((z188*(z409-ite(z206,((z59*(z209*(z207*z431)))+(z221*z408)),((z59*z431)+(z205*z408)))))+(z222*((z186*z432)+(z187*(z185*z417))))));
            z434 = (z7/z271);
            z435 = (z247*(z249*((z230*(-z429))+(z38*z429))));
            z436 = (((z235*z435)-(z233*(z251*(z252*z435))))/z253);
            z437 = (z241*(-(-(z35*z436))));
            z438 = (z240*z405);
            z439 = ((z437-(z267*z438))/z257);
            z440 = (z2*(((z6*((z173*z424)+(z18*z433)))/z67)+(z264*ite(z269,(-((z54*(z434*ite(z269,(z270*z439),z65)))+(z272*z405))),(-((z54*z439)+(z268*z405)))))));
            z441 = (z2*((((z6*((z18*z261)+(z173*z262)))/z67)+(z263*z10))+(z227*z375)));
            z442 = (((-z3)*z1)*z5);
            z443 = (z58*z25);
            z444 = (z76-z7);
            z445 = (z444/z76);
            z446 = (z445*z63);
            z447 = (z7-z187);
            z448 = (z276*(z41*(z3/z39)));
            z449 = ((z3-(-(z39*z388)))/z54);
            z450 = (z60*z449);
            z451 = ite(z57,(z59*(z95*z450)),(z59*z449));
            z452 = (z113*(z114*z450));
            z453 = (z116*z449);
            z454 = (z111*(z112*ite(z66,ite(z57,(z38*z452),(z38*z453)),ite(z57,(z72*z452),(z72*z453)))));
            z455 = ite(z66,z65,(z110*(z67*z454)));
            z456 = (z77*(((z76*(z451/z58))-(z64*z455))/z120));
            z457 = (z91*(z93*(z94*((z39*(z39*z448))+(z456+z456)))));
            z458 = (((z84*z457)-(z80*(z124*(z126*z457))))/z127);
            z459 = (-z458);
            z460 = (z90*z459);
            z461 = (z131*z459);
            z462 = ((z88*z459)+(z87*(z20*z459)));
            z463 = (((z89*((z63*((z460+((z132*z459)+(z86*z461)))+((z136*z459)+(z86*((z135*z459)+(z86*(z134*z459)))))))+(z139*z451)))-(z140*z462))/z142);
            z464 = (z85*z458);
            z465 = (-(z464+z464));
            z466 = ite(z19,z463,(((z144*z465)+(z147*z463))+((z171*z458)+(z85*((z170*z458)+(z85*ite(z153,(z164*z451),(z169*z451))))))));
            z467 = (((z89*((z63*((z461+((z138*z459)+(z86*z460)))+((z175*z459)+(z86*((z174*z459)+(z86*(z137*z459)))))))+(z176*z451)))-(z177*z462))/z142);
            z468 = ((z3-(-z397))/z54);
            z469 = (z463+z467);
            z470 = (ite(z19,z467,(((z179*z465)+(z147*z467))+((z184*z458)+(z85*((z183*z458)+(z85*ite(z153,(z182*z451),(z168*z451))))))))-((z188*(z451-ite(z206,(z59*(z209*(z207*z468))),(z59*z468))))+(z222*((z186*z469)+(z187*((z185*z459)+(z86*(-z448))))))));
            z471 = ((z3-(-(z35*z395)))/z241);
            z472 = (z3-(z54*z471));
            z473 = (z3*(z226*z3));
            z474 = (z2*((((z6*((z173*z466)+(z18*z470)))/z67)+z263)+((z264*ite(z269,(z3-(z54*(z434*ite(z269,(z270*z471),z65)))),z472))+(z273*z473))));
            z475 = ((z255-(z267*z256))/z257);
            z476 = (z2*(((z6*((z173*z172)+(z18*z224)))/z67)+(z264*ite(z269,(-((z54*(z434*ite(z269,(z270*z475),z65)))+(z272*z104))),(-((z54*z475)+(z268*z104)))))));
            z477 = MOD.parm_vals{26};
            z478 = ((z380*((z387*z236)*z1))+(z21*z477));
            z479 = ((z362-(z363-z365))/z54);
            z480 = ((z380*(z1*((z387*z372)+(z236*(z148*ite(z383,(z59*(z396*(z384*z479))),(z59*z479)))))))+(z477*z16));
            z481 = ((z97-((z25*((z7/(z67*z266))*(ite((z265>z65),z7,z16)*z370)))-z327))/z241);
            z482 = (z2*((((z6*((z173*z315)+(z18*z324)))/z67)+z369)+((z264*ite(z269,(z97-(z54*(z434*ite(z269,(z270*z481),z65)))),(z97-(z54*z481))))+(z273*z376))));
            z483 = (((z54*(z427-(z428-z430)))-(z381*z405))/z105);
            z484 = (z380*(z1*((z387*z436)+(z236*(z148*ite(z383,((z59*(z396*(z384*z483)))+(z386*z408)),((z59*z483)+(z382*z408))))))));
            z485 = ((-(-z373))/z241);
            z486 = (z2*(((z6*((z173*z359)+(z18*z368)))/z67)+(z264*ite(z269,(-(z54*(z434*ite(z269,(z270*z485),z65)))),(-(z54*z485))))));
            z487 = ((z318-(z319-z321))/z54);
            z488 = ((z380*(z1*((z387*z326)+(z236*(z148*ite(z383,(z59*(z396*(z384*z487))),(z59*z487)))))))+z477);
            z489 = (z16/z378);
            z490 = ((z437-(z239*z438))/z257);
            z491 = (z2*(((z6*((z18*z424)+(z173*z433)))/z67)+(z227*ite(z243,(-((z54*(z246*ite(z243,(z244*z490),z65)))+(z259*z405))),(-((z54*z490)+(z242*z405)))))));
            z492 = (z2*((((z6*((z18*z466)+(z173*z470)))/z67)+z263)+((z227*ite(z243,(z3-(z54*(z246*ite(z243,(z244*z471),z65)))),z472))+(z375*z473))));
            
            J_out.Jfe.dfe_dvecX(3, 3) = (z16*z489);
            J_out.Jfi.dfi_dvecY(1, 2) = z480;
            J_out.Jfe.dfe_dvecX(3, 1) = z65;
            fqei_out.fe(3, 1) = (-z401);
            J_out.Jqe.dqe_dvecX(3, 2) = z65;
            J_out.Jfi.dfi_dvecX(2, 1) = (-z484);
            J_out.Jqi.dqi_dvecX(1, 1) = z440;
            fqei_out.qi(1, 1) = z274;
            J_out.Jqi.dqi_dvecX(1, 3) = z476;
            J_out.Jqe.dqe_dvecX(3, 1) = z65;
            J_out.Jqe.dqe_dvecX(2, 1) = (z16*((z491+z440)+(z442*((z443*z412)+((z446*(-z432))+(z447*((z445*z409)+(z63*(((z76*z413)-(z444*z413))/z120)))))))));
            J_out.Jqe.dqe_dvecY(1, 2) = z65;
            fqei_out.fe(1, 1) = z379;
            fqei_out.qe(1, 1) = z65;
            J_out.Jfe.dfe_dvecY(2, 2) = z65;
            J_out.Jqi.dqi_dvecX(1, 2) = z474;
            J_out.Jqi.dqi_dvecY(1, 1) = z482;
            J_out.Jqe.dqe_dvecY(3, 1) = z65;
            J_out.Jfe.dfe_dvecX(2, 3) = z65;
            J_out.Jqe.dqe_dvecX(2, 3) = (z16*((z260+z476)+(z442*((z443*z118)+((z446*(-z223))+(z447*((z445*z109)+(z63*(((z76*z119)-(z444*z119))/z120)))))))));
            J_out.Jqe.dqe_dvecY(3, 2) = z65;
            fqei_out.qi(2, 1) = z441;
            J_out.Jfi.dfi_dvecX(1, 3) = z403;
            J_out.Jqe.dqe_dvecX(2, 2) = (z16*((z492+z474)+(z442*((z443*z454)+((z446*(-z469))+(z447*((z445*z451)+(z63*(((z76*z455)-(z444*z455))/z120)))))))));
            fqei_out.fi(2, 1) = (z401-z478);
            J_out.Jqe.dqe_dvecY(2, 2) = (z16*((z377+z486)+(z442*((z443*z340)+((z446*(-z367))+(z447*((z445*z337)+(z63*(((z76*z341)-(z444*z341))/z120)))))))));
            fqei_out.qe(3, 1) = z65;
            fqei_out.fe(2, 1) = z65;
            J_out.Jfe.dfe_dvecX(2, 1) = z65;
            J_out.Jqi.dqi_dvecX(2, 2) = z492;
            J_out.Jfe.dfe_dvecX(1, 1) = z400;
            J_out.Jfe.dfe_dvecY(2, 1) = z65;
            J_out.Jfi.dfi_dvecX(2, 2) = (-z399);
            fqei_out.qe(2, 1) = (-((z441+z274)+(z442*((z443*z74)+(z446*z447)))));
            J_out.Jfe.dfe_dvecX(2, 2) = z65;
            J_out.Jfi.dfi_dvecY(2, 1) = (-z488);
            J_out.Jfe.dfe_dvecX(3, 2) = z65;
            J_out.Jqi.dqi_dvecY(2, 1) = z329;
            J_out.Jqi.dqi_dvecX(2, 1) = z491;
            J_out.Jfi.dfi_dvecX(2, 3) = (z489-z403);
            J_out.Jfi.dfi_dvecX(1, 1) = (z484-z400);
            J_out.Jqe.dqe_dvecY(1, 1) = z65;
            J_out.Jqe.dqe_dvecX(1, 2) = z65;
            J_out.Jqe.dqe_dvecX(3, 3) = z65;
            J_out.Jqi.dqi_dvecY(2, 2) = z377;
            J_out.Jqi.dqi_dvecY(1, 2) = z486;
            J_out.Jfe.dfe_dvecY(3, 1) = z65;
            J_out.Jfe.dfe_dvecX(1, 3) = z65;
            J_out.Jfe.dfe_dvecX(1, 2) = z65;
            J_out.Jqe.dqe_dvecY(2, 1) = (z16*((z329+z482)+(z442*((z443*z291)+((z446*(-z323))+(z447*((z445*z288)+(z63*(((z76*z292)-(z444*z292))/z120)))))))));
            J_out.Jfi.dfi_dvecY(2, 2) = (z400-z480);
            J_out.Jfi.dfi_dvecX(1, 2) = z399;
            J_out.Jfi.dfi_dvecY(1, 1) = (z488-z489);
            J_out.Jqe.dqe_dvecX(1, 3) = z65;
            J_out.Jqe.dqe_dvecX(1, 1) = z65;
            J_out.Jfe.dfe_dvecY(3, 2) = (z16*z400);
            J_out.Jfe.dfe_dvecY(1, 2) = z65;
            J_out.Jqi.dqi_dvecX(2, 3) = z260;
            J_out.Jfe.dfe_dvecY(1, 1) = z489;
            fqei_out.fi(1, 1) = (z478-z379);

        end

    else

        if (do_fe && ~do_qe && ~do_fi && ~do_qi && ~do_J)

            % fqei_out.fe = zeros(3, 1);
            J_out = zeros(0, 0);
            
            z1 = ((1.000000000000e-04/MOD.parm_vals{3})*MOD.parm_vals{10});
            
            fqei_out.fe(1, 1) = ((vecX(1)-vecLim(1))/z1);
            fqei_out.fe(2, 1) = 0.000000000000e+00;
            fqei_out.fe(3, 1) = (-((vecLim(3)-vecX(3))/z1));

        elseif (~do_fe && do_qe && ~do_fi && ~do_qi && ~do_J)

            % fqei_out.qe = zeros(3, 1);
            J_out = zeros(0, 0);
            
            z1 = MOD.parm_vals{3};
            z2 = (-z1);
            z3 = MOD.parm_vals{2};
            z4 = MOD.parm_vals{5};
            z5 = (MOD.parm_vals{4}-z4);
            z6 = (z3*z5);
            z7 = 1.000000000000e+00;
            z8 = vecLim(2);
            z9 = vecLim(3);
            z10 = (z8-z9);
            z11 = (z3*z10);
            z12 = vecLim(1);
            z13 = (z8-z12);
            z14 = (z3*z13);
            z15 = (z11>=z14);
            z16 = ite(z15,z7,-1.000000000000e+00);
            z17 = (z7+z16);
            z18 = (MOD.parm_vals{23}==z7);
            z19 = ite(z15,z11,z14);
            z20 = MOD.parm_vals{20};
            z21 = MOD.parm_vals{19};
            z22 = MOD.parm_vals{18};
            z23 = (z3*(-z9));
            z24 = (z3*(-z12));
            z25 = ite(z15,z23,z24);
            z26 = sqrt(z22);
            z27 = (z20+(z21*(sqrt(abs((z22-z25)))-z26)));
            z28 = ite(z15,(z3*(z12-z9)),(z3*(z9-z12)));
            z29 = MOD.parm_vals{8};
            z30 = (z28*z29);
            z31 = (z27-z30);
            z32 = vecX(3);
            z33 = vecX(1);
            z34 = ((MOD.parm_vals{17}*1.380650300000e-23)/1.602191800000e-19);
            z35 = (MOD.parm_vals{21}*z34);
            z36 = (z7/(z7+exp(((ite(z15,(z3*(z8-z32)),(z3*(z8-z33)))-((z20+(z21*(sqrt(abs((z22-ite(z15,(z3*(-z32)),(z3*(-z33))))))-z26)))-z30))/(z35*1.500000000000e+00)))));
            z37 = ((MOD.parm_vals{9}+(MOD.parm_vals{25}*ite(z15,(z3*(z33-z32)),(z3*(z32-z33)))))*z34);
            z38 = ((z19-(z31-(z36*z35)))/z37);
            z39 = 4.000000000000e+01;
            z40 = (z38<=z39);
            z41 = MOD.parm_vals{6};
            z42 = (z41*z37);
            z43 = exp(z38);
            z44 = ite(z40,(z42*log((z7+z43))),(z42*z38));
            z45 = 6.000000000000e+00;
            z46 = 5.000000000000e-01;
            z47 = (z46*z35);
            z48 = (z7/(z7+exp(((z19-(z31-z47))/z35))));
            z49 = 0.000000000000e+00;
            z50 = (z21==z49);
            z51 = 2.000000000000e+00;
            z52 = (z7+log(log((1.000000000100e+00+z43))));
            z53 = (z7+log(z38));
            z54 = (((z7-z21)/(z7+z21))*z34);
            z55 = sqrt(abs((ite(z50,ite(z40,(z22+(z34*z52)),(z22+(z34*z53))),ite(z40,(z22+(z54*z52)),(z22+(z54*z53))))-z25)));
            z56 = ite(z50,z7,(z7+(z21/(z51*z55))));
            z57 = ((z44/z41)/z56);
            z58 = abs((z28/sqrt((((z48*z35)*z35)+(z57*z57)))));
            z59 = MOD.parm_vals{16};
            z60 = (z7/z59);
            z61 = (z58/((z7+(z58^z59))^z60));
            z62 = (z7-z61);
            z63 = (1.200000000000e+01*z62);
            z64 = (8.000000000000e+00*z62);
            z65 = 4.000000000000e+00;
            z66 = (z7+z62);
            z67 = ((1.500000000000e+01*z66)*z66);
            z68 = ((z44*(((z45+z63)+(z64*z62))+(((z65*z62)*z62)*z62)))/z67);
            z69 = (z7-(z61*z61));
            z70 = MOD.parm_vals{14};
            z71 = 1.000000000000e+02;
            z72 = ((1.000000000000e-10*z70)/z71);
            z73 = (9.100000000000e-31*MOD.parm_vals{22});
            z74 = 3.204383600000e-19;
            z75 = (z28<=(((z72*z72)*z73)/z74));
            z76 = ((z74/z73)*z28);
            z77 = ite(z75,z49,((sqrt(z76)/z70)*z71));
            z78 = ite(z75,((z76/(z70*z70))*1.000000000000e+04),(z77*z77));
            z79 = (z78*z78);
            z80 = ((sqrt((z78+z7))-z7)/z78);
            z81 = ite(z18,z68,((z68*z69)+((ite(z75,(z44*((z46-(z78/2.400000000000e+01))+(z79/8.000000000000e+01))),(z44*((asinh(z77)/z77)-z80)))*z61)*z61)));
            z82 = (z7-z16);
            z83 = ((z44*(((z65+z64)+(z63*z62))+(((z45*z62)*z62)*z62)))/z67);
            z84 = (z68+z83);
            z85 = ((z51*(z7-(9.900000000000e-01*z36)))*z34);
            z86 = (((z7+(z51*z29))*(z85/z51))*exp(((-z28)/z85)));
            z87 = (z7/(z7+exp((((z19+z86)-(((z20+(z21*(sqrt(abs((z22-(z25+z86))))-z26)))-z30)-z47))/z35))));
            z88 = ((z19-(z27-(z87*z35)))/z37);
            z89 = (ite(z18,z83,((z83*z69)+((ite(z75,(z44*((z46-(1.250000000000e-01*z78))+(z79/1.600000000000e+01))),(z44*z80))*z61)*z61)))-((((z7-z48)*z62)*z84)*(z44-ite((z88<=z39),(z42*log((z7+exp(z88)))),(z42*z88)))));
            z90 = ((((3.450000000000e-13/MOD.parm_vals{7})*z4)/z51)+MOD.parm_vals{13});
            z91 = MOD.parm_vals{12};
            z92 = MOD.parm_vals{24};
            z93 = abs((z28/((((z70*z5)/MOD.parm_vals{15})*(z7-z87))+(z34*z87))));
            z94 = (z30*(z93/((z7+(z93^z59))^z60)));
            z95 = (z35*z46);
            z96 = (1.100000000000e+00*z37);
            z97 = (((z11-((z20+(z21*(sqrt(abs((z22-z23)))-z26)))-z94))+z95)/z96);
            z98 = (z97<=z39);
            z99 = (((z14-((z20+(z21*(sqrt(abs((z22-z24)))-z26)))-z94))+z95)/z96);
            z100 = (z99<=z39);
            
            fqei_out.qe(2, 1) = (-(((z2*((((z6*((z17*z81)+(z82*z89)))/z51)+(z90*z10))+((z3*(z91+(z92*z11)))*ite(z98,(z11-(z37*log(ite(z98,(z7+exp(z97)),z49)))),(z11-(z37*z97))))))+(z2*((((z6*((z82*z81)+(z17*z89)))/z51)+(z90*z13))+((z3*(z91+(z92*z14)))*ite(z100,(z14-(z37*log(ite(z100,(z7+exp(z99)),z49)))),(z14-(z37*z99)))))))+((((-z3)*z1)*z5)*(((z41*z21)*z55)+((((z56-z7)/z56)*z44)*(z7-z84))))));
            fqei_out.qe(3, 1) = z49;
            fqei_out.qe(1, 1) = z49;
        
        elseif (~do_fe && ~do_qe && do_fi && ~do_qi && ~do_J)

            % fqei_out.fi = zeros(2, 1);
            J_out = zeros(0, 0);
            
            z1 = vecLim(3);
            z2 = vecX(3);
            z3 = MOD.parm_vals{3};
            z4 = ((1.000000000000e-04/z3)*MOD.parm_vals{10});
            z5 = MOD.parm_vals{2};
            z6 = vecLim(2);
            z7 = (z5*(z6-z1));
            z8 = vecLim(1);
            z9 = (z5*(z6-z8));
            z10 = (z7>=z9);
            z11 = 1.000000000000e+00;
            z12 = 2.000000000000e+00;
            z13 = MOD.parm_vals{8};
            z14 = vecX(1);
            z15 = MOD.parm_vals{20};
            z16 = MOD.parm_vals{19};
            z17 = MOD.parm_vals{18};
            z18 = sqrt(z17);
            z19 = (z8-z1);
            z20 = ite(z10,(z5*z19),(z5*(z1-z8)));
            z21 = (z20*z13);
            z22 = ((MOD.parm_vals{17}*1.380650300000e-23)/1.602191800000e-19);
            z23 = (MOD.parm_vals{21}*z22);
            z24 = ((z12*(z11-(9.900000000000e-01*(z11/(z11+exp(((ite(z10,(z5*(z6-z2)),(z5*(z6-z14)))-((z15+(z16*(sqrt(abs((z17-ite(z10,(z5*(-z2)),(z5*(-z14))))))-z18)))-z21))/(z23*1.500000000000e+00))))))))*z22);
            z25 = (((z11+(z12*z13))*(z24/z12))*exp(((-z20)/z24)));
            z26 = (ite(z10,z7,z9)+z25);
            z27 = ((z15+(z16*(sqrt(abs((z17-(ite(z10,(z5*(-z1)),(z5*(-z8)))+z25))))-z18)))-z21);
            z28 = (z11/(z11+exp(((z26-(z27-(5.000000000000e-01*z23)))/z23))));
            z29 = ((MOD.parm_vals{9}+(MOD.parm_vals{25}*ite(z10,(z5*(z14-z2)),(z5*(z2-z14)))))*z22);
            z30 = ((z26-(z27-(z28*z23)))/z29);
            z31 = (MOD.parm_vals{6}*z29);
            z32 = MOD.parm_vals{14};
            z33 = abs((z20/((((z32*(MOD.parm_vals{4}-MOD.parm_vals{5}))/MOD.parm_vals{15})*(z11-z28))+(z22*z28))));
            z34 = MOD.parm_vals{16};
            z35 = (((z5*ite(z10,z11,-1.000000000000e+00))*(((ite((z30<=4.000000000000e+01),(z31*log((z11+exp(z30)))),(z31*z30))*z32)*(z33/((z11+(z33^z34))^(z11/z34))))*z3))+(z19*MOD.parm_vals{26}));
            
            fqei_out.fi(2, 1) = (((z1-z2)/z4)-z35);
            fqei_out.fi(1, 1) = (z35-((z14-z8)/z4));

        elseif (~do_fe && ~do_qe && ~do_fi && do_qi && ~do_J)

            % fqei_out.qi = zeros(2, 1);
            J_out = zeros(0, 0);
            
            z1 = (-MOD.parm_vals{3});
            z2 = MOD.parm_vals{2};
            z3 = MOD.parm_vals{5};
            z4 = (MOD.parm_vals{4}-z3);
            z5 = (z2*z4);
            z6 = 1.000000000000e+00;
            z7 = vecLim(2);
            z8 = vecLim(3);
            z9 = (z7-z8);
            z10 = (z2*z9);
            z11 = vecLim(1);
            z12 = (z7-z11);
            z13 = (z2*z12);
            z14 = (z10>=z13);
            z15 = ite(z14,z6,-1.000000000000e+00);
            z16 = (z6+z15);
            z17 = (MOD.parm_vals{23}==z6);
            z18 = ite(z14,z10,z13);
            z19 = MOD.parm_vals{20};
            z20 = MOD.parm_vals{19};
            z21 = MOD.parm_vals{18};
            z22 = (z2*(-z8));
            z23 = (z2*(-z11));
            z24 = ite(z14,z22,z23);
            z25 = sqrt(z21);
            z26 = (z19+(z20*(sqrt(abs((z21-z24)))-z25)));
            z27 = ite(z14,(z2*(z11-z8)),(z2*(z8-z11)));
            z28 = MOD.parm_vals{8};
            z29 = (z27*z28);
            z30 = (z26-z29);
            z31 = vecX(3);
            z32 = vecX(1);
            z33 = ((MOD.parm_vals{17}*1.380650300000e-23)/1.602191800000e-19);
            z34 = (MOD.parm_vals{21}*z33);
            z35 = (z6/(z6+exp(((ite(z14,(z2*(z7-z31)),(z2*(z7-z32)))-((z19+(z20*(sqrt(abs((z21-ite(z14,(z2*(-z31)),(z2*(-z32))))))-z25)))-z29))/(z34*1.500000000000e+00)))));
            z36 = ((MOD.parm_vals{9}+(MOD.parm_vals{25}*ite(z14,(z2*(z32-z31)),(z2*(z31-z32)))))*z33);
            z37 = ((z18-(z30-(z35*z34)))/z36);
            z38 = 4.000000000000e+01;
            z39 = (z37<=z38);
            z40 = MOD.parm_vals{6};
            z41 = (z40*z36);
            z42 = exp(z37);
            z43 = ite(z39,(z41*log((z6+z42))),(z41*z37));
            z44 = 6.000000000000e+00;
            z45 = 5.000000000000e-01;
            z46 = (z45*z34);
            z47 = (z6/(z6+exp(((z18-(z30-z46))/z34))));
            z48 = 0.000000000000e+00;
            z49 = (z20==z48);
            z50 = 2.000000000000e+00;
            z51 = (z6+log(log((1.000000000100e+00+z42))));
            z52 = (z6+log(z37));
            z53 = (((z6-z20)/(z6+z20))*z33);
            z54 = ((z43/z40)/ite(z49,z6,(z6+(z20/(z50*sqrt(abs((ite(z49,ite(z39,(z21+(z33*z51)),(z21+(z33*z52))),ite(z39,(z21+(z53*z51)),(z21+(z53*z52))))-z24))))))));
            z55 = abs((z27/sqrt((((z47*z34)*z34)+(z54*z54)))));
            z56 = MOD.parm_vals{16};
            z57 = (z6/z56);
            z58 = (z55/((z6+(z55^z56))^z57));
            z59 = (z6-z58);
            z60 = (1.200000000000e+01*z59);
            z61 = (8.000000000000e+00*z59);
            z62 = 4.000000000000e+00;
            z63 = (z6+z59);
            z64 = ((1.500000000000e+01*z63)*z63);
            z65 = ((z43*(((z44+z60)+(z61*z59))+(((z62*z59)*z59)*z59)))/z64);
            z66 = (z6-(z58*z58));
            z67 = MOD.parm_vals{14};
            z68 = 1.000000000000e+02;
            z69 = ((1.000000000000e-10*z67)/z68);
            z70 = (9.100000000000e-31*MOD.parm_vals{22});
            z71 = 3.204383600000e-19;
            z72 = (z27<=(((z69*z69)*z70)/z71));
            z73 = ((z71/z70)*z27);
            z74 = ite(z72,z48,((sqrt(z73)/z67)*z68));
            z75 = ite(z72,((z73/(z67*z67))*1.000000000000e+04),(z74*z74));
            z76 = (z75*z75);
            z77 = ((sqrt((z75+z6))-z6)/z75);
            z78 = ite(z17,z65,((z65*z66)+((ite(z72,(z43*((z45-(z75/2.400000000000e+01))+(z76/8.000000000000e+01))),(z43*((asinh(z74)/z74)-z77)))*z58)*z58)));
            z79 = (z6-z15);
            z80 = ((z43*(((z62+z61)+(z60*z59))+(((z44*z59)*z59)*z59)))/z64);
            z81 = ((z50*(z6-(9.900000000000e-01*z35)))*z33);
            z82 = (((z6+(z50*z28))*(z81/z50))*exp(((-z27)/z81)));
            z83 = (z6/(z6+exp((((z18+z82)-(((z19+(z20*(sqrt(abs((z21-(z24+z82))))-z25)))-z29)-z46))/z34))));
            z84 = ((z18-(z26-(z83*z34)))/z36);
            z85 = (ite(z17,z80,((z80*z66)+((ite(z72,(z43*((z45-(1.250000000000e-01*z75))+(z76/1.600000000000e+01))),(z43*z77))*z58)*z58)))-((((z6-z47)*z59)*(z65+z80))*(z43-ite((z84<=z38),(z41*log((z6+exp(z84)))),(z41*z84)))));
            z86 = ((((3.450000000000e-13/MOD.parm_vals{7})*z3)/z50)+MOD.parm_vals{13});
            z87 = MOD.parm_vals{12};
            z88 = MOD.parm_vals{24};
            z89 = abs((z27/((((z67*z4)/MOD.parm_vals{15})*(z6-z83))+(z33*z83))));
            z90 = (z29*(z89/((z6+(z89^z56))^z57)));
            z91 = (z34*z45);
            z92 = (1.100000000000e+00*z36);
            z93 = (((z10-((z19+(z20*(sqrt(abs((z21-z22)))-z25)))-z90))+z91)/z92);
            z94 = (z93<=z38);
            z95 = (((z13-((z19+(z20*(sqrt(abs((z21-z23)))-z25)))-z90))+z91)/z92);
            z96 = (z95<=z38);
            
            fqei_out.qi(1, 1) = (z1*((((z5*((z79*z78)+(z16*z85)))/z50)+(z86*z12))+((z2*(z87+(z88*z13)))*ite(z96,(z13-(z36*log(ite(z96,(z6+exp(z95)),z48)))),(z13-(z36*z95))))));
            fqei_out.qi(2, 1) = (z1*((((z5*((z16*z78)+(z79*z85)))/z50)+(z86*z9))+((z2*(z87+(z88*z10)))*ite(z94,(z10-(z36*log(ite(z94,(z6+exp(z93)),z48)))),(z10-(z36*z93))))));

        else

            % fqei_out.fe = zeros(3, 1);
            % fqei_out.qe = zeros(3, 1);
            % fqei_out.fi = zeros(2, 1);
            % fqei_out.qi = zeros(2, 1);
            J_out.Jfe.dfe_dvecX = zeros(3, 3);
            J_out.Jfe.dfe_dvecY = zeros(3, 2);
            J_out.Jfe.dfe_dvecLim = zeros(3, 3);
            J_out.Jfe.dfe_dvecU = zeros(3, 0);
            J_out.Jqe.dqe_dvecX = zeros(3, 3);
            J_out.Jqe.dqe_dvecY = zeros(3, 2);
            J_out.Jqe.dqe_dvecLim = zeros(3, 3);
            J_out.Jfi.dfi_dvecX = zeros(2, 3);
            J_out.Jfi.dfi_dvecY = zeros(2, 2);
            J_out.Jfi.dfi_dvecLim = zeros(2, 3);
            J_out.Jfi.dfi_dvecU = zeros(2, 0);
            J_out.Jqi.dqi_dvecX = zeros(2, 3);
            J_out.Jqi.dqi_dvecY = zeros(2, 2);
            J_out.Jqi.dqi_dvecLim = zeros(2, 3);
            
            z1 = MOD.parm_vals{3};
            z2 = (-z1);
            z3 = MOD.parm_vals{2};
            z4 = MOD.parm_vals{5};
            z5 = (MOD.parm_vals{4}-z4);
            z6 = (z3*z5);
            z7 = 1.000000000000e+00;
            z8 = vecLim(2);
            z9 = vecLim(3);
            z10 = (z8-z9);
            z11 = (z3*z10);
            z12 = vecLim(1);
            z13 = (z8-z12);
            z14 = (z3*z13);
            z15 = (z11>=z14);
            z16 = -1.000000000000e+00;
            z17 = ite(z15,z7,z16);
            z18 = (z7+z17);
            z19 = (MOD.parm_vals{23}==z7);
            z20 = 1.500000000000e+01;
            z21 = (z12-z9);
            z22 = ite(z15,(z3*z21),(z3*(z9-z12)));
            z23 = ite(z15,z11,z14);
            z24 = MOD.parm_vals{20};
            z25 = MOD.parm_vals{19};
            z26 = MOD.parm_vals{18};
            z27 = (z3*(-z9));
            z28 = (z3*(-z12));
            z29 = ite(z15,z27,z28);
            z30 = (z26-z29);
            z31 = sqrt(abs(z30));
            z32 = sqrt(z26);
            z33 = (z24+(z25*(z31-z32)));
            z34 = MOD.parm_vals{8};
            z35 = (z22*z34);
            z36 = (z33-z35);
            z37 = 5.000000000000e-01;
            z38 = ((MOD.parm_vals{17}*1.380650300000e-23)/1.602191800000e-19);
            z39 = (MOD.parm_vals{21}*z38);
            z40 = (z37*z39);
            z41 = exp(((z23-(z36-z40))/z39));
            z42 = (z7+z41);
            z43 = (z7/z42);
            z44 = vecX(3);
            z45 = vecX(1);
            z46 = (z26-ite(z15,(z3*(-z44)),(z3*(-z45))));
            z47 = sqrt(abs(z46));
            z48 = (z39*1.500000000000e+00);
            z49 = exp(((ite(z15,(z3*(z8-z44)),(z3*(z8-z45)))-((z24+(z25*(z47-z32)))-z35))/z48));
            z50 = (z7+z49);
            z51 = (z7/z50);
            z52 = (z23-(z36-(z51*z39)));
            z53 = MOD.parm_vals{25};
            z54 = ((MOD.parm_vals{9}+(z53*ite(z15,(z3*(z45-z44)),(z3*(z44-z45)))))*z38);
            z55 = (z52/z54);
            z56 = 4.000000000000e+01;
            z57 = (z55<=z56);
            z58 = MOD.parm_vals{6};
            z59 = (z58*z54);
            z60 = exp(z55);
            z61 = (z7+z60);
            z62 = log(z61);
            z63 = ite(z57,(z59*z62),(z59*z55));
            z64 = (z63/z58);
            z65 = 0.000000000000e+00;
            z66 = (z25==z65);
            z67 = 2.000000000000e+00;
            z68 = (1.000000000100e+00+z60);
            z69 = log(z68);
            z70 = (z7+log(z69));
            z71 = (z7+log(z55));
            z72 = (((z7-z25)/(z7+z25))*z38);
            z73 = (ite(z66,ite(z57,(z26+(z38*z70)),(z26+(z38*z71))),ite(z57,(z26+(z72*z70)),(z26+(z72*z71))))-z29);
            z74 = sqrt(abs(z73));
            z75 = (z67*z74);
            z76 = ite(z66,z7,(z7+(z25/z75)));
            z77 = (z64/z76);
            z78 = sqrt((((z43*z39)*z39)+(z77*z77)));
            z79 = (z22/z78);
            z80 = abs(z79);
            z81 = MOD.parm_vals{16};
            z82 = (z7+(z80^z81));
            z83 = (z7/z81);
            z84 = (z82^z83);
            z85 = (z80/z84);
            z86 = (z7-z85);
            z87 = (z7+z86);
            z88 = (z20*z87);
            z89 = (z88*z87);
            z90 = 1.200000000000e+01;
            z91 = ite((z79>z65),z7,z16);
            z92 = (z3*z16);
            z93 = ite(z15,z3,z92);
            z94 = (z7/(z67*z78));
            z95 = (z16/(z42^z67));
            z96 = ite(z15,z65,z92);
            z97 = (z7/(z67*z31));
            z98 = ite((z30>z65),z7,z16);
            z99 = (-z96);
            z100 = (z25*(z97*(z98*z99)));
            z101 = (z34*z93);
            z102 = (z100-z101);
            z103 = (z95*(z41*((z96-z102)/z39)));
            z104 = (z7/z61);
            z105 = (z16/(z50^z67));
            z106 = (z105*(z49*((-(-z101))/z48)));
            z107 = ((z96-(z102-(z39*z106)))/z54);
            z108 = (z60*z107);
            z109 = ite(z57,(z59*(z104*z108)),(z59*z107));
            z110 = (z25*(z16/(z75^z67)));
            z111 = (z7/z75);
            z112 = ite((z73>z65),z7,z16);
            z113 = (z7/z69);
            z114 = (z7/z68);
            z115 = (z113*(z114*z108));
            z116 = (z7/z55);
            z117 = (z116*z107);
            z118 = (z111*(z112*(ite(z66,ite(z57,(z38*z115),(z38*z117)),ite(z57,(z72*z115),(z72*z117)))-z96)));
            z119 = ite(z66,z65,(z110*(z67*z118)));
            z120 = (z76^z67);
            z121 = (z77*(((z76*(z109/z58))-(z64*z119))/z120));
            z122 = (z78^z67);
            z123 = (z91*(((z78*z93)-(z22*(z94*((z39*(z39*z103))+(z121+z121)))))/z122));
            z124 = (z83-z7);
            z125 = (z83*(z82^z124));
            z126 = (z81-z7);
            z127 = (z81*(z80^z126));
            z128 = (z84^z67);
            z129 = (((z84*z123)-(z80*(z125*(z127*z123))))/z128);
            z130 = (-z129);
            z131 = (z90*z130);
            z132 = 8.000000000000e+00;
            z133 = (z132*z86);
            z134 = (z132*z130);
            z135 = 4.000000000000e+00;
            z136 = (z135*z86);
            z137 = (z136*z86);
            z138 = 6.000000000000e+00;
            z139 = (z90*z86);
            z140 = (((z138+z139)+(z133*z86))+(z137*z86));
            z141 = (z63*z140);
            z142 = ((z88*z130)+(z87*(z20*z130)));
            z143 = (z89^z67);
            z144 = (((z89*((z63*((z131+((z133*z130)+(z86*z134)))+((z137*z130)+(z86*((z136*z130)+(z86*(z135*z130)))))))+(z140*z109)))-(z141*z142))/z143);
            z145 = (z141/z89);
            z146 = (z85*z129);
            z147 = (-(z146+z146));
            z148 = (z7-(z85*z85));
            z149 = MOD.parm_vals{14};
            z150 = 1.000000000000e+02;
            z151 = ((1.000000000000e-10*z149)/z150);
            z152 = (9.100000000000e-31*MOD.parm_vals{22});
            z153 = 3.204383600000e-19;
            z154 = (z22<=(((z151*z151)*z152)/z153));
            z155 = (z153/z152);
            z156 = (z155*z22);
            z157 = (z149*z149);
            z158 = 1.000000000000e+04;
            z159 = sqrt(z156);
            z160 = ite(z154,z65,((z159/z149)*z150));
            z161 = ite(z154,((z156/z157)*z158),(z160*z160));
            z162 = 2.400000000000e+01;
            z163 = (z161*z161);
            z164 = 8.000000000000e+01;
            z165 = ((z37-(z161/z162))+(z163/z164));
            z166 = asinh(z160);
            z167 = sqrt((z161+z7));
            z168 = (z167-z7);
            z169 = (z168/z161);
            z170 = ((z166/z160)-z169);
            z171 = ite(z154,(z63*z165),(z63*z170));
            z172 = (z171*z85);
            z173 = (z155*z93);
            z174 = (z7/(z67*z159));
            z175 = ite(z154,z65,(z150*((z174*z173)/z149)));
            z176 = (z160*z175);
            z177 = ite(z154,(z158*(z173/z157)),(z176+z176));
            z178 = (z161*z177);
            z179 = (z178+z178);
            z180 = (z160^z67);
            z181 = (z7/sqrt((z7+z180)));
            z182 = (z7/(z67*z167));
            z183 = (z161^z67);
            z184 = (((z161*(z182*z177))-(z168*z177))/z183);
            z185 = ite(z19,z144,(((z145*z147)+(z148*z144))+((z172*z129)+(z85*((z171*z129)+(z85*ite(z154,((z63*((-(z177/z162))+(z179/z164)))+(z165*z109)),((z63*((((z160*(z181*z175))-(z166*z175))/z180)-z184))+(z170*z109)))))))));
            z186 = (z7-z17);
            z187 = (z138*z86);
            z188 = (z187*z86);
            z189 = (((z135+z133)+(z139*z86))+(z188*z86));
            z190 = (z63*z189);
            z191 = (((z89*((z63*((z134+((z139*z130)+(z86*z131)))+((z188*z130)+(z86*((z187*z130)+(z86*(z138*z130)))))))+(z189*z109)))-(z190*z142))/z143);
            z192 = (z190/z89);
            z193 = 1.250000000000e-01;
            z194 = 1.600000000000e+01;
            z195 = ((z37-(z193*z161))+(z163/z194));
            z196 = ite(z154,(z63*z195),(z63*z169));
            z197 = (z196*z85);
            z198 = (z7-z43);
            z199 = (z198*z86);
            z200 = (z145+z192);
            z201 = (z199*z200);
            z202 = (z7+(z67*z34));
            z203 = 9.900000000000e-01;
            z204 = ((z67*(z7-(z203*z51)))*z38);
            z205 = (z202*(z204/z67));
            z206 = (-z22);
            z207 = exp((z206/z204));
            z208 = (z205*z207);
            z209 = (z23+z208);
            z210 = (z26-(z29+z208));
            z211 = sqrt(abs(z210));
            z212 = ((z24+(z25*(z211-z32)))-z35);
            z213 = exp(((z209-(z212-z40))/z39));
            z214 = (z7+z213);
            z215 = (z7/z214);
            z216 = (z215*z39);
            z217 = (z23-(z33-z216));
            z218 = (z217/z54);
            z219 = (z218<=z56);
            z220 = exp(z218);
            z221 = (z7+z220);
            z222 = (z7/z221);
            z223 = (z16/(z214^z67));
            z224 = (z38*(z67*(-(z203*z106))));
            z225 = (z204^z67);
            z226 = (z96+((z205*(z207*(((z204*(z16*z93))-(z206*z224))/z225)))+(z207*(z202*(z224/z67)))));
            z227 = (z7/(z67*z211));
            z228 = ite((z210>z65),z7,z16);
            z229 = ((z25*(z227*(z228*(-z226))))-z101);
            z230 = (z223*(z213*((z226-z229)/z39)));
            z231 = (z39*z230);
            z232 = ((z96-(z100-z231))/z54);
            z233 = log(z221);
            z234 = (z63-ite(z219,(z59*z233),(z59*z218)));
            z235 = (z144+z191);
            z236 = (ite(z19,z191,(((z192*z147)+(z148*z191))+((z197*z129)+(z85*((z196*z129)+(z85*ite(z154,((z63*((-(z193*z177))+(z179/z194)))+(z195*z109)),((z63*z184)+(z169*z109)))))))))-((z201*(z109-ite(z219,(z59*(z222*(z220*z232))),(z59*z232))))+(z234*((z199*z235)+(z200*((z198*z130)+(z86*(-z103))))))));
            z237 = MOD.parm_vals{12};
            z238 = MOD.parm_vals{24};
            z239 = (z3*(z237+(z238*z11)));
            z240 = (z26-z27);
            z241 = sqrt(abs(z240));
            z242 = ((z149*z5)/MOD.parm_vals{15});
            z243 = ((z242*(z7-z215))+(z38*z215));
            z244 = (z22/z243);
            z245 = abs(z244);
            z246 = (z7+(z245^z81));
            z247 = (z246^z83);
            z248 = (z245/z247);
            z249 = (z35*z248);
            z250 = (z39*z37);
            z251 = ((z11-((z24+(z25*(z241-z32)))-z249))+z250);
            z252 = 1.100000000000e+00;
            z253 = (z252*z54);
            z254 = (z251/z253);
            z255 = (z254<=z56);
            z256 = exp(z254);
            z257 = ite(z255,(z7+z256),z65);
            z258 = (z7/z257);
            z259 = ite((z244>z65),z7,z16);
            z260 = (z243^z67);
            z261 = (z259*(((z243*z93)-(z22*((z242*(-z230))+(z38*z230))))/z260));
            z262 = (z83*(z246^z124));
            z263 = (z81*(z245^z126));
            z264 = (z247^z67);
            z265 = (((z247*z261)-(z245*(z262*(z263*z261))))/z264);
            z266 = ((z35*z265)+(z248*z101));
            z267 = ((-(-z266))/z253);
            z268 = (z2*(((z6*((z18*z185)+(z186*z236)))/z67)+(z239*ite(z255,(-(z54*(z258*ite(z255,(z256*z267),z65)))),(-(z54*z267))))));
            z269 = (z3*z17);
            z270 = (z209-(z212-z216));
            z271 = (z270/z54);
            z272 = (z271<=z56);
            z273 = exp(z271);
            z274 = (z7+z273);
            z275 = log(z274);
            z276 = (ite(z272,(z59*z275),(z59*z271))*z149);
            z277 = ite(z15,z92,z3);
            z278 = ite(z15,z92,z65);
            z279 = (z34*z277);
            z280 = (z105*(z49*((-(-z279))/z48)));
            z281 = (z38*(z67*(-(z203*z280))));
            z282 = (z278+((z205*(z207*(((z204*(z16*z277))-(z206*z281))/z225)))+(z207*(z202*(z281/z67)))));
            z283 = ((z25*(z227*(z228*(-z282))))-z279);
            z284 = (z223*(z213*((z282-z283)/z39)));
            z285 = (z259*(((z243*z277)-(z22*((z242*(-z284))+(z38*z284))))/z260));
            z286 = (((z247*z285)-(z245*(z262*(z263*z285))))/z264);
            z287 = (z7/z274);
            z288 = (z39*z284);
            z289 = ((z282-(z283-z288))/z54);
            z290 = MOD.parm_vals{26};
            z291 = ((z269*(z1*((z276*z286)+(z248*(z149*ite(z272,(z59*(z287*(z273*z289))),(z59*z289)))))))+(z290*z16));
            z292 = ite(z19,z145,((z145*z148)+(z172*z85)));
            z293 = (ite(z19,z192,((z192*z148)+(z197*z85)))-(z201*z234));
            z294 = ((((3.450000000000e-13/MOD.parm_vals{7})*z4)/z67)+MOD.parm_vals{13});
            z295 = log(z257);
            z296 = ite(z255,(z11-(z54*z295)),(z11-(z54*z254)));
            z297 = (z2*((((z6*((z18*z292)+(z186*z293)))/z67)+(z294*z10))+(z239*z296)));
            z298 = (z22*(z16/z260));
            z299 = (z206*(z16/z225));
            z300 = (z7/(z67*z47));
            z301 = ite((z46>z65),z7,z16);
            z302 = (z105*(z49*((z96-(z25*(z300*(z301*z99))))/z48)));
            z303 = (z38*(z67*(-(z203*z302))));
            z304 = ((z205*(z207*(z299*z303)))+(z207*(z202*(z303/z67))));
            z305 = (z25*(z227*(z228*(-z304))));
            z306 = (z223*(z213*((z304-z305)/z39)));
            z307 = (z259*(z298*((z242*(-z306))+(z38*z306))));
            z308 = (((z247*z307)-(z245*(z262*(z263*z307))))/z264);
            z309 = (z39*z306);
            z310 = (z38*(z53*z93));
            z311 = (z54^z67);
            z312 = (((z54*(z304-(z305-z309)))-(z270*z310))/z311);
            z313 = (z58*z310);
            z314 = (z269*(z1*((z276*z308)+(z248*(z149*ite(z272,((z59*(z287*(z273*z312)))+(z275*z313)),((z59*z312)+(z271*z313))))))));
            z315 = ((1.000000000000e-04/z1)*MOD.parm_vals{10});
            z316 = (z7/z315);
            z317 = (z22*(z16/z122));
            z318 = (z95*(z41*(z3/z39)));
            z319 = (z105*(z49*(z3/z48)));
            z320 = ((z3-(-(z39*z319)))/z54);
            z321 = (z60*z320);
            z322 = ite(z57,(z59*(z104*z321)),(z59*z320));
            z323 = (z113*(z114*z321));
            z324 = (z116*z320);
            z325 = (z111*(z112*ite(z66,ite(z57,(z38*z323),(z38*z324)),ite(z57,(z72*z323),(z72*z324)))));
            z326 = ite(z66,z65,(z110*(z67*z325)));
            z327 = (z77*(((z76*(z322/z58))-(z64*z326))/z120));
            z328 = (z91*(z317*(z94*((z39*(z39*z318))+(z327+z327)))));
            z329 = (((z84*z328)-(z80*(z125*(z127*z328))))/z128);
            z330 = (-z329);
            z331 = (z90*z330);
            z332 = (z132*z330);
            z333 = ((z88*z330)+(z87*(z20*z330)));
            z334 = (((z89*((z63*((z331+((z133*z330)+(z86*z332)))+((z137*z330)+(z86*((z136*z330)+(z86*(z135*z330)))))))+(z140*z322)))-(z141*z333))/z143);
            z335 = (z85*z329);
            z336 = (-(z335+z335));
            z337 = ite(z19,z334,(((z145*z336)+(z148*z334))+((z172*z329)+(z85*((z171*z329)+(z85*ite(z154,(z165*z322),(z170*z322))))))));
            z338 = (((z89*((z63*((z332+((z139*z330)+(z86*z331)))+((z188*z330)+(z86*((z187*z330)+(z86*(z138*z330)))))))+(z189*z322)))-(z190*z333))/z143);
            z339 = (z38*(z67*(-(z203*z319))));
            z340 = ((z205*(z207*(z299*z339)))+(z207*(z202*(z339/z67))));
            z341 = (z3+z340);
            z342 = (z25*(z227*(z228*(-z340))));
            z343 = (z223*(z213*((z341-z342)/z39)));
            z344 = (z39*z343);
            z345 = ((z3-(-z344))/z54);
            z346 = (z334+z338);
            z347 = (ite(z19,z338,(((z192*z336)+(z148*z338))+((z197*z329)+(z85*((z196*z329)+(z85*ite(z154,(z195*z322),(z169*z322))))))))-((z201*(z322-ite(z219,(z59*(z222*(z220*z345))),(z59*z345))))+(z234*((z199*z346)+(z200*((z198*z330)+(z86*(-z318))))))));
            z348 = (z259*(z298*((z242*(-z343))+(z38*z343))));
            z349 = (((z247*z348)-(z245*(z262*(z263*z348))))/z264);
            z350 = ((z3-(-(z35*z349)))/z253);
            z351 = (z3-(z54*z350));
            z352 = (z3*(z238*z3));
            z353 = (z2*((((z6*((z18*z337)+(z186*z347)))/z67)+z294)+((z239*ite(z255,(z3-(z54*(z258*ite(z255,(z256*z350),z65)))),z351))+(z296*z352))));
            z354 = (-z278);
            z355 = (z25*(z97*(z98*z354)));
            z356 = (z355-z279);
            z357 = (z95*(z41*((z278-z356)/z39)));
            z358 = ((z278-(z356-(z39*z280)))/z54);
            z359 = (z60*z358);
            z360 = ite(z57,(z59*(z104*z359)),(z59*z358));
            z361 = (z113*(z114*z359));
            z362 = (z116*z358);
            z363 = (z111*(z112*(ite(z66,ite(z57,(z38*z361),(z38*z362)),ite(z57,(z72*z361),(z72*z362)))-z278)));
            z364 = ite(z66,z65,(z110*(z67*z363)));
            z365 = (z77*(((z76*(z360/z58))-(z64*z364))/z120));
            z366 = (z91*(((z78*z277)-(z22*(z94*((z39*(z39*z357))+(z365+z365)))))/z122));
            z367 = (((z84*z366)-(z80*(z125*(z127*z366))))/z128);
            z368 = (-z367);
            z369 = (z90*z368);
            z370 = (z132*z368);
            z371 = ((z88*z368)+(z87*(z20*z368)));
            z372 = (((z89*((z63*((z369+((z133*z368)+(z86*z370)))+((z137*z368)+(z86*((z136*z368)+(z86*(z135*z368)))))))+(z140*z360)))-(z141*z371))/z143);
            z373 = (z85*z367);
            z374 = (-(z373+z373));
            z375 = (z155*z277);
            z376 = ite(z154,z65,(z150*((z174*z375)/z149)));
            z377 = (z160*z376);
            z378 = ite(z154,(z158*(z375/z157)),(z377+z377));
            z379 = (z161*z378);
            z380 = (z379+z379);
            z381 = (((z161*(z182*z378))-(z168*z378))/z183);
            z382 = ite(z19,z372,(((z145*z374)+(z148*z372))+((z172*z367)+(z85*((z171*z367)+(z85*ite(z154,((z63*((-(z378/z162))+(z380/z164)))+(z165*z360)),((z63*((((z160*(z181*z376))-(z166*z376))/z180)-z381))+(z170*z360)))))))));
            z383 = (((z89*((z63*((z370+((z139*z368)+(z86*z369)))+((z188*z368)+(z86*((z187*z368)+(z86*(z138*z368)))))))+(z189*z360)))-(z190*z371))/z143);
            z384 = ((z278-(z355-z288))/z54);
            z385 = (z372+z383);
            z386 = (ite(z19,z383,(((z192*z374)+(z148*z383))+((z197*z367)+(z85*((z196*z367)+(z85*ite(z154,((z63*((-(z193*z378))+(z380/z194)))+(z195*z360)),((z63*z381)+(z169*z360)))))))))-((z201*(z360-ite(z219,(z59*(z222*(z220*z384))),(z59*z384))))+(z234*((z199*z385)+(z200*((z198*z368)+(z86*(-z357))))))));
            z387 = (z294*z16);
            z388 = (-z92);
            z389 = ((z35*z286)+(z248*z279));
            z390 = ((z92-((z25*((z7/(z67*z241))*(ite((z240>z65),z7,z16)*z388)))-z389))/z253);
            z391 = (z3*(z238*z92));
            z392 = (z2*((((z6*((z18*z382)+(z186*z386)))/z67)+z387)+((z239*ite(z255,(z92-(z54*(z258*ite(z255,(z256*z390),z65)))),(z92-(z54*z390))))+(z296*z391))));
            z393 = ((z226-(z229-z231))/z54);
            z394 = ((z269*(z1*((z276*z265)+(z248*(z149*ite(z272,(z59*(z287*(z273*z393))),(z59*z393)))))))+z290);
            z395 = (z16/z315);
            z396 = ((z9-z44)/z315);
            z397 = ((z269*((z276*z248)*z1))+(z21*z290));
            z398 = (z3*(z237+(z238*z14)));
            z399 = (z26-z28);
            z400 = sqrt(abs(z399));
            z401 = ((z14-((z24+(z25*(z400-z32)))-z249))+z250);
            z402 = (z401/z253);
            z403 = (z402<=z56);
            z404 = exp(z402);
            z405 = ite(z403,(z7+z404),z65);
            z406 = log(z405);
            z407 = ite(z403,(z14-(z54*z406)),(z14-(z54*z402)));
            z408 = (z2*((((z6*((z186*z292)+(z18*z293)))/z67)+(z294*z13))+(z398*z407)));
            z409 = (z105*(z49*((z278-(z25*(z300*(z301*z354))))/z48)));
            z410 = (z38*(z67*(-(z203*z409))));
            z411 = ((z205*(z207*(z299*z410)))+(z207*(z202*(z410/z67))));
            z412 = (z25*(z227*(z228*(-z411))));
            z413 = (z223*(z213*((z411-z412)/z39)));
            z414 = (z259*(z298*((z242*(-z413))+(z38*z413))));
            z415 = (((z247*z414)-(z245*(z262*(z263*z414))))/z264);
            z416 = (z39*z413);
            z417 = (z38*(z53*z277));
            z418 = (((z54*(z411-(z412-z416)))-(z270*z417))/z311);
            z419 = (z58*z417);
            z420 = (z269*(z1*((z276*z415)+(z248*(z149*ite(z272,((z59*(z287*(z273*z418)))+(z275*z419)),((z59*z418)+(z271*z419))))))));
            z421 = ((z45-z12)/z315);
            z422 = (((z54*(-(-(z39*z302))))-(z52*z310))/z311);
            z423 = (z60*z422);
            z424 = ite(z57,((z59*(z104*z423))+(z62*z313)),((z59*z422)+(z55*z313)));
            z425 = (z113*(z114*z423));
            z426 = (z116*z422);
            z427 = (z111*(z112*ite(z66,ite(z57,(z38*z425),(z38*z426)),ite(z57,(z72*z425),(z72*z426)))));
            z428 = ite(z66,z65,(z110*(z67*z427)));
            z429 = (z77*(((z76*(z424/z58))-(z64*z428))/z120));
            z430 = (z91*(z317*(z94*(z429+z429))));
            z431 = (((z84*z430)-(z80*(z125*(z127*z430))))/z128);
            z432 = (-z431);
            z433 = (z90*z432);
            z434 = (z132*z432);
            z435 = ((z88*z432)+(z87*(z20*z432)));
            z436 = (((z89*((z63*((z433+((z133*z432)+(z86*z434)))+((z137*z432)+(z86*((z136*z432)+(z86*(z135*z432)))))))+(z140*z424)))-(z141*z435))/z143);
            z437 = (z85*z431);
            z438 = (-(z437+z437));
            z439 = ite(z19,z436,(((z145*z438)+(z148*z436))+((z172*z431)+(z85*((z171*z431)+(z85*ite(z154,(z165*z424),(z170*z424))))))));
            z440 = (((z89*((z63*((z434+((z139*z432)+(z86*z433)))+((z188*z432)+(z86*((z187*z432)+(z86*(z138*z432)))))))+(z189*z424)))-(z190*z435))/z143);
            z441 = (((z54*(-(-z309)))-(z217*z310))/z311);
            z442 = (z436+z440);
            z443 = (ite(z19,z440,(((z192*z438)+(z148*z440))+((z197*z431)+(z85*((z196*z431)+(z85*ite(z154,(z195*z424),(z169*z424))))))))-((z201*(z424-ite(z219,((z59*(z222*(z220*z441)))+(z233*z313)),((z59*z441)+(z218*z313)))))+(z234*((z199*z442)+(z200*(z198*z432))))));
            z444 = (z7/z405);
            z445 = (z253*(-(-(z35*z308))));
            z446 = (z252*z310);
            z447 = (z253^z67);
            z448 = ((z445-(z401*z446))/z447);
            z449 = (z2*(((z6*((z186*z439)+(z18*z443)))/z67)+(z398*ite(z403,(-((z54*(z444*ite(z403,(z404*z448),z65)))+(z406*z310))),(-((z54*z448)+(z402*z310)))))));
            z450 = ((z341-(z342-z344))/z54);
            z451 = (z269*(z1*((z276*z349)+(z248*(z149*ite(z272,(z59*(z287*(z273*z450))),(z59*z450)))))));
            z452 = (((z54*(-(-(z39*z409))))-(z52*z417))/z311);
            z453 = (z60*z452);
            z454 = ite(z57,((z59*(z104*z453))+(z62*z419)),((z59*z452)+(z55*z419)));
            z455 = (z113*(z114*z453));
            z456 = (z116*z452);
            z457 = (z111*(z112*ite(z66,ite(z57,(z38*z455),(z38*z456)),ite(z57,(z72*z455),(z72*z456)))));
            z458 = ite(z66,z65,(z110*(z67*z457)));
            z459 = (z77*(((z76*(z454/z58))-(z64*z458))/z120));
            z460 = (z91*(z317*(z94*(z459+z459))));
            z461 = (((z84*z460)-(z80*(z125*(z127*z460))))/z128);
            z462 = (-z461);
            z463 = (z90*z462);
            z464 = (z132*z462);
            z465 = ((z88*z462)+(z87*(z20*z462)));
            z466 = (((z89*((z63*((z463+((z133*z462)+(z86*z464)))+((z137*z462)+(z86*((z136*z462)+(z86*(z135*z462)))))))+(z140*z454)))-(z141*z465))/z143);
            z467 = (z85*z461);
            z468 = (-(z467+z467));
            z469 = ite(z19,z466,(((z145*z468)+(z148*z466))+((z172*z461)+(z85*((z171*z461)+(z85*ite(z154,(z165*z454),(z170*z454))))))));
            z470 = (((z89*((z63*((z464+((z139*z462)+(z86*z463)))+((z188*z462)+(z86*((z187*z462)+(z86*(z138*z462)))))))+(z189*z454)))-(z190*z465))/z143);
            z471 = (((z54*(-(-z416)))-(z217*z417))/z311);
            z472 = (z466+z470);
            z473 = (ite(z19,z470,(((z192*z468)+(z148*z470))+((z197*z461)+(z85*((z196*z461)+(z85*ite(z154,(z195*z454),(z169*z454))))))))-((z201*(z454-ite(z219,((z59*(z222*(z220*z471)))+(z233*z419)),((z59*z471)+(z218*z419)))))+(z234*((z199*z472)+(z200*(z198*z462))))));
            z474 = (z253*(-(-(z35*z415))));
            z475 = (z252*z417);
            z476 = ((z474-(z401*z475))/z447);
            z477 = (z2*(((z6*((z186*z469)+(z18*z473)))/z67)+(z398*ite(z403,(-((z54*(z444*ite(z403,(z404*z476),z65)))+(z406*z417))),(-((z54*z476)+(z402*z417)))))));
            z478 = ((z92-((z25*((z7/(z67*z400))*(ite((z399>z65),z7,z16)*z388)))-z266))/z253);
            z479 = (z2*((((z6*((z186*z185)+(z18*z236)))/z67)+z387)+((z398*ite(z403,(z92-(z54*(z444*ite(z403,(z404*z478),z65)))),(z92-(z54*z478))))+(z407*z391))));
            z480 = (z2*((((z6*((z186*z337)+(z18*z347)))/z67)+z294)+((z398*ite(z403,(z3-(z54*(z444*ite(z403,(z404*z350),z65)))),z351))+(z407*z352))));
            z481 = ((-(-z389))/z253);
            z482 = (z2*(((z6*((z186*z382)+(z18*z386)))/z67)+(z398*ite(z403,(-(z54*(z444*ite(z403,(z404*z481),z65)))),(-(z54*z481))))));
            z483 = (((-z3)*z1)*z5);
            z484 = (z58*z25);
            z485 = (z76-z7);
            z486 = (z485/z76);
            z487 = (z486*z63);
            z488 = (z7-z200);
            z489 = ((z445-(z251*z446))/z447);
            z490 = (z2*(((z6*((z18*z439)+(z186*z443)))/z67)+(z239*ite(z255,(-((z54*(z258*ite(z255,(z256*z489),z65)))+(z295*z310))),(-((z54*z489)+(z254*z310)))))));
            z491 = ((z474-(z251*z475))/z447);
            z492 = (z2*(((z6*((z18*z469)+(z186*z473)))/z67)+(z239*ite(z255,(-((z54*(z258*ite(z255,(z256*z491),z65)))+(z295*z417))),(-((z54*z491)+(z254*z417)))))));
            
            J_out.Jfe.dfe_dvecX(3, 3) = (z16*z395);
            J_out.Jfi.dfi_dvecY(1, 2) = z65;
            J_out.Jqi.dqi_dvecLim(1, 3) = z482;
            J_out.Jfe.dfe_dvecX(3, 1) = z65;
            J_out.Jqe.dqe_dvecX(1, 3) = z65;
            J_out.Jqe.dqe_dvecX(2, 1) = (z16*((z490+z449)+(z483*((z484*z427)+((z487*(-z442))+(z488*((z486*z424)+(z63*(((z76*z428)-(z485*z428))/z120)))))))));
            J_out.Jfi.dfi_dvecX(2, 1) = (-z314);
            J_out.Jfe.dfe_dvecLim(3, 3) = (z16*z316);
            J_out.Jqe.dqe_dvecX(1, 2) = z65;
            J_out.Jqi.dqi_dvecLim(2, 3) = z392;
            J_out.Jqe.dqe_dvecX(3, 1) = z65;
            J_out.Jqi.dqi_dvecY(1, 1) = z65;
            fqei_out.qe(1, 1) = z65;
            J_out.Jfe.dfe_dvecY(2, 2) = z65;
            J_out.Jqi.dqi_dvecX(1, 2) = z65;
            J_out.Jqe.dqe_dvecY(3, 1) = z65;
            J_out.Jqe.dqe_dvecX(2, 3) = (z16*((z492+z477)+(z483*((z484*z457)+((z487*(-z472))+(z488*((z486*z454)+(z63*(((z76*z458)-(z485*z458))/z120)))))))));
            fqei_out.qi(2, 1) = z297;
            J_out.Jfe.dfe_dvecLim(1, 1) = z395;
            J_out.Jqe.dqe_dvecX(2, 2) = z65;
            J_out.Jfe.dfe_dvecY(1, 1) = z65;
            J_out.Jqe.dqe_dvecLim(2, 1) = (z16*((z268+z479)+(z483*((z484*z118)+((z487*(-z235))+(z488*((z486*z109)+(z63*(((z76*z119)-(z485*z119))/z120)))))))));
            J_out.Jqi.dqi_dvecLim(2, 1) = z268;
            J_out.Jqe.dqe_dvecLim(3, 1) = z65;
            J_out.Jqi.dqi_dvecLim(1, 2) = z480;
            J_out.Jfe.dfe_dvecLim(3, 2) = z65;
            J_out.Jqi.dqi_dvecX(2, 2) = z65;
            J_out.Jfe.dfe_dvecX(1, 1) = z316;
            J_out.Jfi.dfi_dvecX(2, 2) = z65;
            J_out.Jqi.dqi_dvecLim(1, 1) = z479;
            J_out.Jfi.dfi_dvecY(2, 1) = z65;
            J_out.Jfi.dfi_dvecLim(2, 3) = (z316-z291);
            J_out.Jqi.dqi_dvecY(2, 1) = z65;
            J_out.Jqi.dqi_dvecX(2, 1) = z490;
            J_out.Jfi.dfi_dvecX(2, 3) = (z395-z420);
            J_out.Jfi.dfi_dvecX(1, 1) = (z314-z316);
            J_out.Jqe.dqe_dvecY(1, 1) = z65;
            J_out.Jfe.dfe_dvecX(2, 3) = z65;
            J_out.Jqe.dqe_dvecX(3, 3) = z65;
            J_out.Jqi.dqi_dvecY(2, 2) = z65;
            J_out.Jfi.dfi_dvecLim(1, 2) = z451;
            J_out.Jfe.dfe_dvecLim(2, 2) = z65;
            J_out.Jfe.dfe_dvecX(1, 3) = z65;
            J_out.Jfe.dfe_dvecX(1, 2) = z65;
            J_out.Jqe.dqe_dvecY(2, 1) = z65;
            J_out.Jfi.dfi_dvecX(1, 2) = z65;
            J_out.Jfi.dfi_dvecLim(1, 1) = (z394-z395);
            fqei_out.fe(1, 1) = z421;
            J_out.Jqi.dqi_dvecY(1, 2) = z65;
            J_out.Jfe.dfe_dvecY(1, 2) = z65;
            J_out.Jfi.dfi_dvecLim(2, 1) = (-z394);
            fqei_out.fi(1, 1) = (z397-z421);
            J_out.Jfi.dfi_dvecLim(1, 3) = z291;
            J_out.Jqe.dqe_dvecLim(2, 3) = (z16*((z392+z482)+(z483*((z484*z363)+((z487*(-z385))+(z488*((z486*z360)+(z63*(((z76*z364)-(z485*z364))/z120)))))))));
            fqei_out.fe(3, 1) = (-z396);
            J_out.Jqe.dqe_dvecX(3, 2) = z65;
            J_out.Jqe.dqe_dvecLim(1, 2) = z65;
            J_out.Jqe.dqe_dvecLim(3, 3) = z65;
            J_out.Jqi.dqi_dvecX(1, 1) = z449;
            fqei_out.qi(1, 1) = z408;
            J_out.Jqi.dqi_dvecX(1, 3) = z477;
            J_out.Jfi.dfi_dvecY(1, 1) = z65;
            J_out.Jfe.dfe_dvecLim(2, 3) = z65;
            J_out.Jqe.dqe_dvecLim(1, 1) = z65;
            J_out.Jqe.dqe_dvecLim(2, 2) = (z16*((z353+z480)+(z483*((z484*z325)+((z487*(-z346))+(z488*((z486*z322)+(z63*(((z76*z326)-(z485*z326))/z120)))))))));
            J_out.Jfe.dfe_dvecLim(2, 1) = z65;
            J_out.Jqe.dqe_dvecY(3, 2) = z65;
            J_out.Jqe.dqe_dvecLim(3, 2) = z65;
            J_out.Jfi.dfi_dvecX(1, 3) = z420;
            fqei_out.fi(2, 1) = (z396-z397);
            J_out.Jqe.dqe_dvecY(2, 2) = z65;
            fqei_out.qe(3, 1) = z65;
            J_out.Jfe.dfe_dvecLim(3, 1) = z65;
            fqei_out.fe(2, 1) = z65;
            J_out.Jfe.dfe_dvecX(2, 1) = z65;
            J_out.Jqe.dqe_dvecY(1, 2) = z65;
            J_out.Jfe.dfe_dvecY(2, 1) = z65;
            fqei_out.qe(2, 1) = (-((z297+z408)+(z483*((z484*z74)+(z487*z488)))));
            J_out.Jfe.dfe_dvecX(2, 2) = z65;
            J_out.Jfe.dfe_dvecX(3, 2) = z65;
            J_out.Jfe.dfe_dvecLim(1, 2) = z65;
            J_out.Jfi.dfi_dvecLim(2, 2) = (-z451);
            J_out.Jqe.dqe_dvecLim(1, 3) = z65;
            J_out.Jfe.dfe_dvecY(3, 1) = z65;
            J_out.Jqi.dqi_dvecX(2, 3) = z492;
            J_out.Jfi.dfi_dvecY(2, 2) = z65;
            J_out.Jfe.dfe_dvecY(3, 2) = z65;
            J_out.Jqe.dqe_dvecX(1, 1) = z65;
            J_out.Jqi.dqi_dvecLim(2, 2) = z353;
            J_out.Jfe.dfe_dvecLim(1, 3) = z65;

        end

    end

end

function out = initGuess(vecU, MOD)

    out = zeros(3, 1);
    
    out(3, 1) = -1.000000000000e+00;
    out(1, 1) = 0.000000000000e+00;
    out(2, 1) = (MOD.parm_vals{2}*MOD.parm_vals{20});

end

function out = dinitGuess_dvecU(vecU, MOD)

    out = zeros(3, 0);

end

function out = limiting(vecX, vecY, vecLim, vecU, MOD)

    out = zeros(3, 1);
    
    z1 = vecLim(1);
    z2 = vecLim(3);
    z3 = (z1-z2);
    z4 = 0.000000000000e+00;
    z5 = (z3>=z4);
    z6 = 3.500000000000e+00;
    z7 = vecLim(2);
    z8 = (z7-z2);
    z9 = (MOD.parm_vals{2}*MOD.parm_vals{20});
    z10 = (z9+z6);
    z11 = vecX(2);
    z12 = vecY(2);
    z13 = (z11-z12);
    z14 = (z13-z8);
    z15 = (z14<=z4);
    z16 = (-z14);
    z17 = 2.000000000000e+00;
    z18 = (abs((z17*(z8-z9)))+z17);
    z19 = ((z18/z17)+z17);
    z20 = (z9+z17);
    z21 = (z13>z20);
    z22 = 1.000000000000e+00;
    z23 = 5.000000000000e-01;
    z24 = (z9-z23);
    z25 = (z13>z24);
    z26 = 4.000000000000e+00;
    z27 = (z9+z26);
    z28 = (z13>z27);
    z29 = (z9+z23);
    z30 = ite((z8>=z9),ite((z8>=z10),ite(z15,ite((z13>=z10),ite((z16>z19),(z8-z19),z13),((z21*z13)+((z22-z21)*z20))),ite((z14>=z18),(z8+z18),z13)),ite(z15,((z25*z13)+((z22-z25)*z24)),((z28*z27)+((z22-z28)*z13)))),ite(z15,ite((z16>z18),(z8-z18),z13),ite((z13<=z29),ite((z14>z19),(z8+z19),z13),z29)));
    z31 = vecY(1);
    z32 = (z11-z31);
    z33 = (z30-z32);
    z34 = (z33>z3);
    z35 = 3.000000000000e+00;
    z36 = ((z35*z3)+z17);
    z37 = (z33>z36);
    z38 = (z33>z17);
    z39 = (z33>z26);
    z40 = -5.000000000000e-01;
    z41 = (z33>z40);
    z42 = (-z3);
    z43 = (z7-z1);
    z44 = (z32-z43);
    z45 = (z44<=z4);
    z46 = (-z44);
    z47 = (abs((z17*(z43-z9)))+z17);
    z48 = ((z47/z17)+z17);
    z49 = (z32>z20);
    z50 = (z32>z24);
    z51 = (z32>z27);
    z52 = ite((z43>=z9),ite((z43>=z10),ite(z45,ite((z32>=z10),ite((z46>z48),(z43-z48),z32),((z49*z32)+((z22-z49)*z20))),ite((z44>=z47),(z43+z47),z32)),ite(z45,((z50*z32)+((z22-z50)*z24)),((z51*z27)+((z22-z51)*z32)))),ite(z45,ite((z46>z47),(z43-z47),z32),ite((z32<=z29),ite((z44>z48),(z43+z48),z32),z29)));
    z53 = (z52-z13);
    z54 = (z53>z42);
    z55 = ((z35*z42)+z17);
    z56 = (z53>z55);
    z57 = (z53>z17);
    z58 = (z53>z26);
    z59 = (z53>z40);
    z60 = (-ite((z42>=z6),ite(z54,((z56*z55)+((z22-z56)*z53)),ite((z53<z6),((z57*z53)+((z22-z57)*z17)),z53)),ite(z54,((z58*z26)+((z22-z58)*z53)),((z59*z53)+((z22-z59)*z40)))));
    z61 = ite(z5,ite((z3>=z6),ite(z34,((z37*z36)+((z22-z37)*z33)),ite((z33<z6),((z38*z33)+((z22-z38)*z17)),z33)),ite(z34,((z39*z26)+((z22-z39)*z33)),((z41*z33)+((z22-z41)*z40)))),z60);
    z62 = (z61>=z4);
    z63 = (-z12);
    z64 = 6.145000000000e-01;
    z65 = (-z2);
    z66 = (z63-z65);
    z67 = 5.200000000000e-02;
    z68 = 2.600000000000e-02;
    z69 = (z22+(z66/z68));
    z70 = ite(and((z63>z64),(abs(z66)>z67)),ite((z65>z4),ite((z69>z4),(z65+(z68*log(z69))),z64),(z68*log((z63/z68)))),z63);
    z71 = (-z31);
    z72 = (-z1);
    z73 = (z71-z72);
    z74 = (z22+(z73/z68));
    z75 = ite(and((z71>z64),(abs(z73)>z67)),ite((z72>z4),ite((z74>z4),(z72+(z68*log(z74))),z64),(z68*log((z71/z68)))),z71);
    z76 = ite(z62,z70,(z75+z61));
    
    out(3, 1) = (-z76);
    out(1, 1) = (-ite(z62,(z70-z61),z75));
    out(2, 1) = (ite(z5,z30,(z52+z60))-z76);

end

function out = dlimiting_dvecX(vecX, vecY, vecLim, vecU, MOD)

    out = zeros(3, 3);
    
    z1 = -1.000000000000e+00;
    z2 = vecLim(1);
    z3 = vecLim(3);
    z4 = (z2-z3);
    z5 = 0.000000000000e+00;
    z6 = (z4>=z5);
    z7 = 3.500000000000e+00;
    z8 = (z4>=z7);
    z9 = vecLim(2);
    z10 = (z9-z3);
    z11 = (MOD.parm_vals{2}*MOD.parm_vals{20});
    z12 = (z10>=z11);
    z13 = (z11+z7);
    z14 = (z10>=z13);
    z15 = vecX(2);
    z16 = (z15-vecY(2));
    z17 = (z16-z10);
    z18 = (z17<=z5);
    z19 = (z16>=z13);
    z20 = (-z17);
    z21 = 2.000000000000e+00;
    z22 = (abs((z21*(z10-z11)))+z21);
    z23 = ((z22/z21)+z21);
    z24 = (z20>z23);
    z25 = (z11+z21);
    z26 = (z16>z25);
    z27 = 1.000000000000e+00;
    z28 = (z17>=z22);
    z29 = 5.000000000000e-01;
    z30 = (z11-z29);
    z31 = (z16>z30);
    z32 = 4.000000000000e+00;
    z33 = (z11+z32);
    z34 = (z16>z33);
    z35 = (z27-z34);
    z36 = (z20>z22);
    z37 = (z11+z29);
    z38 = (z16<=z37);
    z39 = (z17>z23);
    z40 = (z15-vecY(1));
    z41 = (ite(z12,ite(z14,ite(z18,ite(z19,ite(z24,(z10-z23),z16),((z26*z16)+((z27-z26)*z25))),ite(z28,(z10+z22),z16)),ite(z18,((z31*z16)+((z27-z31)*z30)),((z34*z33)+(z35*z16)))),ite(z18,ite(z36,(z10-z22),z16),ite(z38,ite(z39,(z10+z23),z16),z37)))-z40);
    z42 = (z41>z4);
    z43 = 3.000000000000e+00;
    z44 = ((z43*z4)+z21);
    z45 = (z41>z44);
    z46 = (z27-z45);
    z47 = (z41<z7);
    z48 = (z41>z21);
    z49 = (z41>z32);
    z50 = (z27-z49);
    z51 = -5.000000000000e-01;
    z52 = (z41>z51);
    z53 = (-z4);
    z54 = (z53>=z7);
    z55 = (z9-z2);
    z56 = (z55>=z11);
    z57 = (z55>=z13);
    z58 = (z40-z55);
    z59 = (z58<=z5);
    z60 = (z40>=z13);
    z61 = (-z58);
    z62 = (abs((z21*(z55-z11)))+z21);
    z63 = ((z62/z21)+z21);
    z64 = (z61>z63);
    z65 = (z40>z25);
    z66 = (z58>=z62);
    z67 = (z40>z30);
    z68 = (z40>z33);
    z69 = (z27-z68);
    z70 = (z61>z62);
    z71 = (z40<=z37);
    z72 = (z58>z63);
    z73 = (ite(z56,ite(z57,ite(z59,ite(z60,ite(z64,(z55-z63),z40),((z65*z40)+((z27-z65)*z25))),ite(z66,(z55+z62),z40)),ite(z59,((z67*z40)+((z27-z67)*z30)),((z68*z33)+(z69*z40)))),ite(z59,ite(z70,(z55-z62),z40),ite(z71,ite(z72,(z55+z63),z40),z37)))-z16);
    z74 = (z73>z53);
    z75 = ((z43*z53)+z21);
    z76 = (z73>z75);
    z77 = (z27-z76);
    z78 = (z73<z7);
    z79 = (z73>z21);
    z80 = (z73>z32);
    z81 = (z27-z80);
    z82 = (z73>z51);
    z83 = (ite(z6,ite(z8,ite(z42,((z45*z44)+(z46*z41)),ite(z47,((z48*z41)+((z27-z48)*z21)),z41)),ite(z42,((z49*z32)+(z50*z41)),((z52*z41)+((z27-z52)*z51)))),(-ite(z54,ite(z74,((z76*z75)+(z77*z73)),ite(z78,((z79*z73)+((z27-z79)*z21)),z73)),ite(z74,((z80*z32)+(z81*z73)),((z82*z73)+((z27-z82)*z51))))))>=z5);
    z84 = ite(z12,ite(z14,ite(z18,ite(z19,ite(z24,z5,z27),z26),ite(z28,z5,z27)),ite(z18,z31,z35)),ite(z18,ite(z36,z5,z27),ite(z38,ite(z39,z5,z27),z5)));
    z85 = (z84-z27);
    z86 = ite(z56,ite(z57,ite(z59,ite(z60,ite(z64,z5,z27),z65),ite(z66,z5,z27)),ite(z59,z67,z69)),ite(z59,ite(z70,z5,z27),ite(z71,ite(z72,z5,z27),z5)));
    z87 = (z86-z27);
    z88 = (z1*ite(z54,ite(z74,(z77*z87),ite(z78,(z79*z87),z87)),ite(z74,(z81*z87),(z82*z87))));
    z89 = ite(z6,ite(z8,ite(z42,(z46*z85),ite(z47,(z48*z85),z85)),ite(z42,(z50*z85),(z52*z85))),z88);
    z90 = ite(z83,z5,z89);
    
    out(3, 3) = z5;
    out(3, 2) = (z1*z90);
    out(2, 3) = z5;
    out(1, 3) = z5;
    out(3, 1) = z5;
    out(1, 2) = (z1*ite(z83,(-z89),z5));
    out(1, 1) = z5;
    out(2, 1) = z5;
    out(2, 2) = (ite(z6,z84,(z86+z88))-z90);

end

function out = dlimiting_dvecY(vecX, vecY, vecLim, vecU, MOD)

    out = zeros(3, 2);
    
    z1 = -1.000000000000e+00;
    z2 = vecLim(1);
    z3 = vecLim(3);
    z4 = (z2-z3);
    z5 = 0.000000000000e+00;
    z6 = (z4>=z5);
    z7 = 3.500000000000e+00;
    z8 = (z4>=z7);
    z9 = vecLim(2);
    z10 = (z9-z3);
    z11 = (MOD.parm_vals{2}*MOD.parm_vals{20});
    z12 = (z10>=z11);
    z13 = (z11+z7);
    z14 = (z10>=z13);
    z15 = vecX(2);
    z16 = vecY(2);
    z17 = (z15-z16);
    z18 = (z17-z10);
    z19 = (z18<=z5);
    z20 = (z17>=z13);
    z21 = (-z18);
    z22 = 2.000000000000e+00;
    z23 = (abs((z22*(z10-z11)))+z22);
    z24 = ((z23/z22)+z22);
    z25 = (z21>z24);
    z26 = (z11+z22);
    z27 = (z17>z26);
    z28 = 1.000000000000e+00;
    z29 = (z18>=z23);
    z30 = 5.000000000000e-01;
    z31 = (z11-z30);
    z32 = (z17>z31);
    z33 = 4.000000000000e+00;
    z34 = (z11+z33);
    z35 = (z17>z34);
    z36 = (z28-z35);
    z37 = (z21>z23);
    z38 = (z11+z30);
    z39 = (z17<=z38);
    z40 = (z18>z24);
    z41 = vecY(1);
    z42 = (z15-z41);
    z43 = (ite(z12,ite(z14,ite(z19,ite(z20,ite(z25,(z10-z24),z17),((z27*z17)+((z28-z27)*z26))),ite(z29,(z10+z23),z17)),ite(z19,((z32*z17)+((z28-z32)*z31)),((z35*z34)+(z36*z17)))),ite(z19,ite(z37,(z10-z23),z17),ite(z39,ite(z40,(z10+z24),z17),z38)))-z42);
    z44 = (z43>z4);
    z45 = 3.000000000000e+00;
    z46 = ((z45*z4)+z22);
    z47 = (z43>z46);
    z48 = (z28-z47);
    z49 = (z43<z7);
    z50 = (z43>z22);
    z51 = (z43>z33);
    z52 = (z28-z51);
    z53 = -5.000000000000e-01;
    z54 = (z43>z53);
    z55 = (-z4);
    z56 = (z55>=z7);
    z57 = (z9-z2);
    z58 = (z57>=z11);
    z59 = (z57>=z13);
    z60 = (z42-z57);
    z61 = (z60<=z5);
    z62 = (z42>=z13);
    z63 = (-z60);
    z64 = (abs((z22*(z57-z11)))+z22);
    z65 = ((z64/z22)+z22);
    z66 = (z63>z65);
    z67 = (z42>z26);
    z68 = (z60>=z64);
    z69 = (z42>z31);
    z70 = (z42>z34);
    z71 = (z28-z70);
    z72 = (z63>z64);
    z73 = (z42<=z38);
    z74 = (z60>z65);
    z75 = (ite(z58,ite(z59,ite(z61,ite(z62,ite(z66,(z57-z65),z42),((z67*z42)+((z28-z67)*z26))),ite(z68,(z57+z64),z42)),ite(z61,((z69*z42)+((z28-z69)*z31)),((z70*z34)+(z71*z42)))),ite(z61,ite(z72,(z57-z64),z42),ite(z73,ite(z74,(z57+z65),z42),z38)))-z17);
    z76 = (z75>z55);
    z77 = ((z45*z55)+z22);
    z78 = (z75>z77);
    z79 = (z28-z78);
    z80 = (z75<z7);
    z81 = (z75>z22);
    z82 = (z75>z33);
    z83 = (z28-z82);
    z84 = (z75>z53);
    z85 = (ite(z6,ite(z8,ite(z44,((z47*z46)+(z48*z43)),ite(z49,((z50*z43)+((z28-z50)*z22)),z43)),ite(z44,((z51*z33)+(z52*z43)),((z54*z43)+((z28-z54)*z53)))),(-ite(z56,ite(z76,((z78*z77)+(z79*z75)),ite(z80,((z81*z75)+((z28-z81)*z22)),z75)),ite(z76,((z82*z33)+(z83*z75)),((z84*z75)+((z28-z84)*z53))))))>=z5);
    z86 = (-z16);
    z87 = 6.145000000000e-01;
    z88 = (-z3);
    z89 = (z86-z88);
    z90 = 5.200000000000e-02;
    z91 = 2.600000000000e-02;
    z92 = (z28+(z89/z91));
    z93 = -3.846153846154e+01;
    z94 = ite(and((z86>z87),(abs(z89)>z90)),ite((z88>z5),ite((z92>z5),(z91*((z28/z92)*z93)),z5),(z91*((z28/(z86/z91))*z93))),z1);
    z95 = ite(z12,ite(z14,ite(z19,ite(z20,ite(z25,z5,z1),(z27*z1)),ite(z29,z5,z1)),ite(z19,(z32*z1),(z36*z1))),ite(z19,ite(z37,z5,z1),ite(z39,ite(z40,z5,z1),z5)));
    z96 = (z1*ite(z56,ite(z76,z79,ite(z80,z81,z28)),ite(z76,z83,z84)));
    z97 = ite(z6,ite(z8,ite(z44,(z48*z95),ite(z49,(z50*z95),z95)),ite(z44,(z52*z95),(z54*z95))),z96);
    z98 = ite(z85,z94,z97);
    z99 = ite(z58,ite(z59,ite(z61,ite(z62,ite(z66,z5,z1),(z67*z1)),ite(z68,z5,z1)),ite(z61,(z69*z1),(z71*z1))),ite(z61,ite(z72,z5,z1),ite(z73,ite(z74,z5,z1),z5)));
    z100 = (z1*ite(z56,ite(z76,(z79*z99),ite(z80,(z81*z99),z99)),ite(z76,(z83*z99),(z84*z99))));
    z101 = (-z41);
    z102 = (-z2);
    z103 = (z101-z102);
    z104 = (z28+(z103/z91));
    z105 = ite(and((z101>z87),(abs(z103)>z90)),ite((z102>z5),ite((z104>z5),(z91*((z28/z104)*z93)),z5),(z91*((z28/(z101/z91))*z93))),z1);
    z106 = ite(z6,ite(z8,ite(z44,z48,ite(z49,z50,z28)),ite(z44,z52,z54)),z100);
    z107 = ite(z85,z5,(z105+z106));
    
    out(3, 2) = (z1*z98);
    out(1, 1) = (z1*ite(z85,(-z106),z105));
    out(3, 1) = (z1*z107);
    out(1, 2) = (z1*ite(z85,(z94-z97),z5));
    out(2, 2) = (ite(z6,z95,z96)-z98);
    out(2, 1) = (ite(z6,z5,(z99+z100))-z107);

end

function out = dlimiting_dvecLim(vecX, vecY, vecLim, vecU, MOD)

    out = zeros(3, 3);
    
    z1 = -1.000000000000e+00;
    z2 = vecLim(1);
    z3 = vecLim(3);
    z4 = (z2-z3);
    z5 = 0.000000000000e+00;
    z6 = (z4>=z5);
    z7 = 3.500000000000e+00;
    z8 = (z4>=z7);
    z9 = vecLim(2);
    z10 = (z9-z3);
    z11 = (MOD.parm_vals{2}*MOD.parm_vals{20});
    z12 = (z10>=z11);
    z13 = (z11+z7);
    z14 = (z10>=z13);
    z15 = vecX(2);
    z16 = vecY(2);
    z17 = (z15-z16);
    z18 = (z17-z10);
    z19 = (z18<=z5);
    z20 = (z17>=z13);
    z21 = (-z18);
    z22 = 2.000000000000e+00;
    z23 = (z22*(z10-z11));
    z24 = (abs(z23)+z22);
    z25 = ((z24/z22)+z22);
    z26 = (z21>z25);
    z27 = (z11+z22);
    z28 = (z17>z27);
    z29 = 1.000000000000e+00;
    z30 = (z18>=z24);
    z31 = 5.000000000000e-01;
    z32 = (z11-z31);
    z33 = (z17>z32);
    z34 = 4.000000000000e+00;
    z35 = (z11+z34);
    z36 = (z17>z35);
    z37 = (z21>z24);
    z38 = (z11+z31);
    z39 = (z17<=z38);
    z40 = (z18>z25);
    z41 = vecY(1);
    z42 = (z15-z41);
    z43 = (ite(z12,ite(z14,ite(z19,ite(z20,ite(z26,(z10-z25),z17),((z28*z17)+((z29-z28)*z27))),ite(z30,(z10+z24),z17)),ite(z19,((z33*z17)+((z29-z33)*z32)),((z36*z35)+((z29-z36)*z17)))),ite(z19,ite(z37,(z10-z24),z17),ite(z39,ite(z40,(z10+z25),z17),z38)))-z42);
    z44 = (z43>z4);
    z45 = 3.000000000000e+00;
    z46 = ((z45*z4)+z22);
    z47 = (z43>z46);
    z48 = (z29-z47);
    z49 = (z43<z7);
    z50 = (z43>z22);
    z51 = (z43>z34);
    z52 = (z29-z51);
    z53 = -5.000000000000e-01;
    z54 = (z43>z53);
    z55 = (-z4);
    z56 = (z55>=z7);
    z57 = (z9-z2);
    z58 = (z57>=z11);
    z59 = (z57>=z13);
    z60 = (z42-z57);
    z61 = (z60<=z5);
    z62 = (z42>=z13);
    z63 = (-z60);
    z64 = (z22*(z57-z11));
    z65 = (abs(z64)+z22);
    z66 = ((z65/z22)+z22);
    z67 = (z63>z66);
    z68 = (z42>z27);
    z69 = (z60>=z65);
    z70 = (z42>z32);
    z71 = (z42>z35);
    z72 = (z63>z65);
    z73 = (z42<=z38);
    z74 = (z60>z66);
    z75 = (ite(z58,ite(z59,ite(z61,ite(z62,ite(z67,(z57-z66),z42),((z68*z42)+((z29-z68)*z27))),ite(z69,(z57+z65),z42)),ite(z61,((z70*z42)+((z29-z70)*z32)),((z71*z35)+((z29-z71)*z42)))),ite(z61,ite(z72,(z57-z65),z42),ite(z73,ite(z74,(z57+z66),z42),z38)))-z17);
    z76 = (z75>z55);
    z77 = ((z45*z55)+z22);
    z78 = (z75>z77);
    z79 = (z29-z78);
    z80 = (z75<z7);
    z81 = (z75>z22);
    z82 = (z75>z34);
    z83 = (z29-z82);
    z84 = (z75>z53);
    z85 = (ite(z6,ite(z8,ite(z44,((z47*z46)+(z48*z43)),ite(z49,((z50*z43)+((z29-z50)*z22)),z43)),ite(z44,((z51*z34)+(z52*z43)),((z54*z43)+((z29-z54)*z53)))),(-ite(z56,ite(z76,((z78*z77)+(z79*z75)),ite(z80,((z81*z75)+((z29-z81)*z22)),z75)),ite(z76,((z82*z34)+(z83*z75)),((z84*z75)+((z29-z84)*z53))))))>=z5);
    z86 = (-z16);
    z87 = 6.145000000000e-01;
    z88 = (-z3);
    z89 = (z86-z88);
    z90 = 5.200000000000e-02;
    z91 = 2.600000000000e-02;
    z92 = (z29+(z89/z91));
    z93 = 3.846153846154e+01;
    z94 = ite(and((z86>z87),(abs(z89)>z90)),ite((z88>z5),ite((z92>z5),(z1+(z91*((z29/z92)*z93))),z5),z5),z5);
    z95 = -3.000000000000e+00;
    z96 = ite((z23>z5),z29,z1);
    z97 = -2.000000000000e+00;
    z98 = (z96*z97);
    z99 = (z98/z22);
    z100 = ite(z12,ite(z14,ite(z19,ite(z20,ite(z26,(z1-z99),z5),z5),ite(z30,(z1+z98),z5)),z5),ite(z19,ite(z37,(z1-z98),z5),ite(z39,ite(z40,(z1+z99),z5),z5)));
    z101 = (z1*ite(z56,ite(z76,(z78*z45),z5),z5));
    z102 = ite(z6,ite(z8,ite(z44,((z47*z95)+(z48*z100)),ite(z49,(z50*z100),z100)),ite(z44,(z52*z100),(z54*z100))),z101);
    z103 = (-z41);
    z104 = (-z2);
    z105 = (z103-z104);
    z106 = (z29+(z105/z91));
    z107 = ite(and((z103>z87),(abs(z105)>z90)),ite((z104>z5),ite((z106>z5),(z1+(z91*((z29/z106)*z93))),z5),z5),z5);
    z108 = ite((z64>z5),z29,z1);
    z109 = (z108*z97);
    z110 = (z109/z22);
    z111 = ite(z58,ite(z59,ite(z61,ite(z62,ite(z67,(z1-z110),z5),z5),ite(z69,(z1+z109),z5)),z5),ite(z61,ite(z72,(z1-z109),z5),ite(z73,ite(z74,(z1+z110),z5),z5)));
    z112 = (z1*ite(z56,ite(z76,((z78*z95)+(z79*z111)),ite(z80,(z81*z111),z111)),ite(z76,(z83*z111),(z84*z111))));
    z113 = ite(z6,ite(z8,ite(z44,(z47*z45),z5),z5),z112);
    z114 = ite(z85,z5,(z107+z113));
    z115 = (z96*z22);
    z116 = (z115/z22);
    z117 = ite(z12,ite(z14,ite(z19,ite(z20,ite(z26,(z29-z116),z5),z5),ite(z30,(z29+z115),z5)),z5),ite(z19,ite(z37,(z29-z115),z5),ite(z39,ite(z40,(z29+z116),z5),z5)));
    z118 = (z108*z22);
    z119 = (z118/z22);
    z120 = ite(z58,ite(z59,ite(z61,ite(z62,ite(z67,(z29-z119),z5),z5),ite(z69,(z29+z118),z5)),z5),ite(z61,ite(z72,(z29-z118),z5),ite(z73,ite(z74,(z29+z119),z5),z5)));
    z121 = (z1*ite(z56,ite(z76,(z79*z120),ite(z80,(z81*z120),z120)),ite(z76,(z83*z120),(z84*z120))));
    z122 = ite(z6,ite(z8,ite(z44,(z48*z117),ite(z49,(z50*z117),z117)),ite(z44,(z52*z117),(z54*z117))),z121);
    z123 = ite(z85,z5,z122);
    z124 = ite(z85,z94,z102);
    
    out(3, 3) = (z1*z124);
    out(3, 2) = (z1*z123);
    out(2, 3) = (ite(z6,z100,z101)-z124);
    out(1, 3) = (z1*ite(z85,(z94-z102),z5));
    out(3, 1) = (z1*z114);
    out(1, 2) = (z1*ite(z85,(-z122),z5));
    out(1, 1) = (z1*ite(z85,(-z113),z107));
    out(2, 1) = (ite(z6,z5,(z111+z112))-z114);
    out(2, 2) = (ite(z6,z117,(z120+z121))-z123);

end

function out = dlimiting_dvecU(vecX, vecY, vecLim, vecU, MOD)

    out = zeros(3, 0);

end

